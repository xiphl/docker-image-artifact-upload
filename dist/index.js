!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=26)}([function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e},s=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.getIDToken=e.getState=e.saveState=e.group=e.endGroup=e.startGroup=e.info=e.notice=e.warning=e.error=e.debug=e.isDebug=e.setFailed=e.setCommandEcho=e.setOutput=e.getBooleanInput=e.getMultilineInput=e.getInput=e.addPath=e.setSecret=e.exportVariable=e.ExitCode=void 0;const a=r(33),c=r(34),u=r(8),l=i(r(4)),h=i(r(1)),d=r(35);var f;function p(t,e){const r=process.env["INPUT_"+t.replace(/ /g,"_").toUpperCase()]||"";if(e&&e.required&&!r)throw new Error("Input required and not supplied: "+t);return e&&!1===e.trimWhitespace?r:r.trim()}function m(t,e={}){a.issueCommand("error",u.toCommandProperties(e),t instanceof Error?t.toString():t)}function g(t){a.issue("group",t)}function y(){a.issue("endgroup")}!function(t){t[t.Success=0]="Success",t[t.Failure=1]="Failure"}(f=e.ExitCode||(e.ExitCode={})),e.exportVariable=function(t,e){const r=u.toCommandValue(e);if(process.env[t]=r,process.env.GITHUB_ENV||""){const e="_GitHubActionsFileCommandDelimeter_",n=`${t}<<${e}${l.EOL}${r}${l.EOL}${e}`;c.issueCommand("ENV",n)}else a.issueCommand("set-env",{name:t},r)},e.setSecret=function(t){a.issueCommand("add-mask",{},t)},e.addPath=function(t){process.env.GITHUB_PATH||""?c.issueCommand("PATH",t):a.issueCommand("add-path",{},t),process.env.PATH=`${t}${h.delimiter}${process.env.PATH}`},e.getInput=p,e.getMultilineInput=function(t,e){return p(t,e).split("\n").filter(t=>""!==t)},e.getBooleanInput=function(t,e){const r=p(t,e);if(["true","True","TRUE"].includes(r))return!0;if(["false","False","FALSE"].includes(r))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${t}\nSupport boolean input list: \`true | True | TRUE | false | False | FALSE\``)},e.setOutput=function(t,e){process.stdout.write(l.EOL),a.issueCommand("set-output",{name:t},e)},e.setCommandEcho=function(t){a.issue("echo",t?"on":"off")},e.setFailed=function(t){process.exitCode=f.Failure,m(t)},e.isDebug=function(){return"1"===process.env.RUNNER_DEBUG},e.debug=function(t){a.issueCommand("debug",{},t)},e.error=m,e.warning=function(t,e={}){a.issueCommand("warning",u.toCommandProperties(e),t instanceof Error?t.toString():t)},e.notice=function(t,e={}){a.issueCommand("notice",u.toCommandProperties(e),t instanceof Error?t.toString():t)},e.info=function(t){process.stdout.write(t+l.EOL)},e.startGroup=g,e.endGroup=y,e.group=function(t,e){return s(this,void 0,void 0,(function*(){let r;g(t);try{r=yield e()}finally{y()}return r}))},e.saveState=function(t,e){a.issueCommand("save-state",{name:t},e)},e.getState=function(t){return process.env["STATE_"+t]||""},e.getIDToken=function(t){return s(this,void 0,void 0,(function*(){return yield d.OidcClient.getIDToken(t)}))};var v=r(15);Object.defineProperty(e,"summary",{enumerable:!0,get:function(){return v.summary}});var w=r(15);Object.defineProperty(e,"markdownSummary",{enumerable:!0,get:function(){return w.markdownSummary}});var b=r(42);Object.defineProperty(e,"toPosixPath",{enumerable:!0,get:function(){return b.toPosixPath}}),Object.defineProperty(e,"toWin32Path",{enumerable:!0,get:function(){return b.toWin32Path}}),Object.defineProperty(e,"toPlatformPath",{enumerable:!0,get:function(){return b.toPlatformPath}})},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("os")},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=r(2),i=r(0),s=r(44),a=r(46),c=r(7);function u(){return"6.0-preview"}e.getExponentialRetryTimeInMilliseconds=function(t){if(t<0)throw new Error("RetryCount should not be negative");if(0===t)return c.getInitialRetryIntervalInMilliseconds();const e=c.getInitialRetryIntervalInMilliseconds()*c.getRetryMultiplier()*t,r=e*c.getRetryMultiplier();return Math.random()*(r-e)+e},e.parseEnvNumber=function(t){const e=Number(process.env[t]);if(!(Number.isNaN(e)||e<0))return e},e.getApiVersion=u,e.isSuccessStatusCode=function(t){return!!t&&(t>=200&&t<300)},e.isForbiddenStatusCode=function(t){return!!t&&t===s.HttpCodes.Forbidden},e.isRetryableStatusCode=function(t){return!!t&&[s.HttpCodes.BadGateway,s.HttpCodes.ServiceUnavailable,s.HttpCodes.GatewayTimeout,s.HttpCodes.TooManyRequests,413].includes(t)},e.isThrottledStatusCode=function(t){return!!t&&t===s.HttpCodes.TooManyRequests},e.tryGetRetryAfterValueTimeInMilliseconds=function(t){if(t["retry-after"]){const e=Number(t["retry-after"]);return isNaN(e)?void o.info(`Returned retry-after header value: ${e} is non-numeric and cannot be used`):(o.info("Retry-After header is present with a value of "+e),1e3*e)}o.info("No retry-after header was found. Dumping all headers for diagnostic purposes"),console.log(t)},e.getContentRange=function(t,e,r){return`bytes ${t}-${e}/${r}`},e.getDownloadHeaders=function(t,e,r){const n={};return t&&(n["Content-Type"]=t),e&&(n.Connection="Keep-Alive",n["Keep-Alive"]="10"),r?(n["Accept-Encoding"]="gzip",n.Accept="application/octet-stream;api-version=6.0-preview"):n.Accept="application/json;api-version=6.0-preview",n},e.getUploadHeaders=function(t,e,r,n,o,i){const s={Accept:"application/json;api-version=6.0-preview"};return t&&(s["Content-Type"]=t),e&&(s.Connection="Keep-Alive",s["Keep-Alive"]="10"),r&&(s["Content-Encoding"]="gzip",s["x-tfs-filelength"]=n),o&&(s["Content-Length"]=o),i&&(s["Content-Range"]=i),s},e.createHttpClient=function(t){return new s.HttpClient(t,[new a.BearerCredentialHandler(c.getRuntimeToken())])},e.getArtifactUrl=function(){const t=`${c.getRuntimeUrl()}_apis/pipelines/workflows/${c.getWorkFlowRunId()}/artifacts?api-version=6.0-preview`;return o.debug("Artifact Url: "+t),t},e.displayHttpDiagnostics=function(t){o.info(`##### Begin Diagnostic HTTP information #####\nStatus Code: ${t.message.statusCode}\nStatus Message: ${t.message.statusMessage}\nHeader Information: ${JSON.stringify(t.message.headers,void 0,2)}\n###### End Diagnostic HTTP information ######`)};const l=['"',":","<",">","|","*","?"],h=[...l,"\\","/"];e.checkArtifactName=function(t){if(!t)throw new Error(`Artifact name: ${t}, is incorrectly provided`);for(const e of h)if(t.includes(e))throw new Error(`Artifact name is not valid: ${t}. Contains character: "${e}". Invalid artifact name characters include: ${h.toString()}.`)},e.checkArtifactFilePath=function(t){if(!t)throw new Error(`Artifact path: ${t}, is incorrectly provided`);for(const e of l)if(t.includes(e))throw new Error(`Artifact path is not valid: ${t}. Contains character: "${e}". Invalid characters include: ${l.toString()}.`)},e.createDirectoriesForArtifact=function(t){return n(this,void 0,void 0,(function*(){for(const e of t)yield i.promises.mkdir(e,{recursive:!0})}))},e.createEmptyFilesForArtifact=function(t){return n(this,void 0,void 0,(function*(){for(const e of t)yield(yield i.promises.open(e,"w")).close()}))},e.getFileSize=function(t){return n(this,void 0,void 0,(function*(){const e=yield i.promises.stat(t);return o.debug(`${t} size:(${e.size}) blksize:(${e.blksize}) blocks:(${e.blocks})`),e.size}))},e.rmFile=function(t){return n(this,void 0,void 0,(function*(){yield i.promises.unlink(t)}))},e.getProperRetention=function(t,e){if(t<0)throw new Error("Invalid retention, minimum value is 1.");let r=t;if(e){const t=parseInt(e);!isNaN(t)&&t<r&&(o.warning(`Retention days is greater than the max value allowed by the repository setting, reduce retention to ${t} days`),r=t)}return r}},function(t,e){t.exports=require("assert")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getUploadFileConcurrency=function(){return 2},e.getUploadChunkSize=function(){return 8388608},e.getRetryLimit=function(){return 5},e.getRetryMultiplier=function(){return 1.5},e.getInitialRetryIntervalInMilliseconds=function(){return 3e3},e.getDownloadFileConcurrency=function(){return 2},e.getRuntimeToken=function(){const t=process.env.ACTIONS_RUNTIME_TOKEN;if(!t)throw new Error("Unable to get ACTIONS_RUNTIME_TOKEN env variable");return t},e.getRuntimeUrl=function(){const t=process.env.ACTIONS_RUNTIME_URL;if(!t)throw new Error("Unable to get ACTIONS_RUNTIME_URL env variable");return t},e.getWorkFlowRunId=function(){const t=process.env.GITHUB_RUN_ID;if(!t)throw new Error("Unable to get GITHUB_RUN_ID env variable");return t},e.getWorkSpaceDirectory=function(){const t=process.env.GITHUB_WORKSPACE;if(!t)throw new Error("Unable to get GITHUB_WORKSPACE env variable");return t},e.getRetentionDays=function(){return process.env.GITHUB_RETENTION_DAYS}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toCommandProperties=e.toCommandValue=void 0,e.toCommandValue=function(t){return null==t?"":"string"==typeof t||t instanceof String?t:JSON.stringify(t)},e.toCommandProperties=function(t){return Object.keys(t).length?{title:t.title,file:t.file,line:t.startLine,endLine:t.endLine,col:t.startColumn,endColumn:t.endColumn}:{}}},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("https")},function(t,e,r){t.exports=l,l.Minimatch=h;var n=function(){try{return r(1)}catch(t){}}()||{sep:"/"};l.sep=n.sep;var o=l.GLOBSTAR=h.GLOBSTAR={},i=r(53),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="().*{}+?[]^$\\!".split("").reduce((function(t,e){return t[e]=!0,t}),{});var c=/\/+/;function u(t,e){e=e||{};var r={};return Object.keys(t).forEach((function(e){r[e]=t[e]})),Object.keys(e).forEach((function(t){r[t]=e[t]})),r}function l(t,e,r){return f(e),r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&new h(e,r).match(t)}function h(t,e){if(!(this instanceof h))return new h(t,e);f(t),e||(e={}),t=t.trim(),e.allowWindowsEscape||"/"===n.sep||(t=t.split(n.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}function d(t,e){return e||(e=this instanceof h?this.options:{}),t=void 0===t?this.pattern:t,f(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:i(t)}l.filter=function(t,e){return e=e||{},function(r,n,o){return l(r,t,e)}},l.defaults=function(t){if(!t||"object"!=typeof t||!Object.keys(t).length)return l;var e=l,r=function(r,n,o){return e(r,n,u(t,o))};return(r.Minimatch=function(r,n){return new e.Minimatch(r,u(t,n))}).defaults=function(r){return e.defaults(u(t,r)).Minimatch},r.filter=function(r,n){return e.filter(r,u(t,n))},r.defaults=function(r){return e.defaults(u(t,r))},r.makeRe=function(r,n){return e.makeRe(r,u(t,n))},r.braceExpand=function(r,n){return e.braceExpand(r,u(t,n))},r.match=function(r,n,o){return e.match(r,n,u(t,o))},r},h.defaults=function(t){return l.defaults(t).Minimatch},h.prototype.debug=function(){},h.prototype.make=function(){var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)});this.debug(this.pattern,r),r=this.globParts=r.map((function(t){return t.split(c)})),this.debug(this.pattern,r),r=r.map((function(t,e,r){return t.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(t){return-1===t.indexOf(!1)})),this.debug(this.pattern,r),this.set=r},h.prototype.parseNegate=function(){var t=this.pattern,e=!1,r=this.options,n=0;if(r.nonegate)return;for(var o=0,i=t.length;o<i&&"!"===t.charAt(o);o++)e=!e,n++;n&&(this.pattern=t.substr(n));this.negate=e},l.braceExpand=function(t,e){return d(t,e)},h.prototype.braceExpand=d;var f=function(t){if("string"!=typeof t)throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")};h.prototype.parse=function(t,e){f(t);var r=this.options;if("**"===t){if(!r.noglobstar)return o;t="*"}if(""===t)return"";var n,i="",c=!!r.nocase,u=!1,l=[],h=[],d=!1,m=-1,g=-1,y="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function w(){if(n){switch(n){case"*":i+="[^/]*?",c=!0;break;case"?":i+="[^/]",c=!0;break;default:i+="\\"+n}v.debug("clearStateChar %j %j",n,i),n=!1}}for(var b,_=0,E=t.length;_<E&&(b=t.charAt(_));_++)if(this.debug("%s\t%s %s %j",t,_,i,b),u&&a[b])i+="\\"+b,u=!1;else switch(b){case"/":return!1;case"\\":w(),u=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,_,i,b),d){this.debug("  in class"),"!"===b&&_===g+1&&(b="^"),i+=b;continue}v.debug("call clearStateChar %j",n),w(),n=b,r.noext&&w();continue;case"(":if(d){i+="(";continue}if(!n){i+="\\(";continue}l.push({type:n,start:_-1,reStart:i.length,open:s[n].open,close:s[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(d||!l.length){i+="\\)";continue}w(),c=!0;var O=l.pop();i+=O.close,"!"===O.type&&h.push(O),O.reEnd=i.length;continue;case"|":if(d||!l.length||u){i+="\\|",u=!1;continue}w(),i+="|";continue;case"[":if(w(),d){i+="\\"+b;continue}d=!0,g=_,m=i.length,i+=b;continue;case"]":if(_===g+1||!d){i+="\\"+b,u=!1;continue}var S=t.substring(g+1,_);try{RegExp("["+S+"]")}catch(t){var A=this.parse(S,p);i=i.substr(0,m)+"\\["+A[0]+"\\]",c=c||A[1],d=!1;continue}c=!0,d=!1,i+=b;continue;default:w(),u?u=!1:!a[b]||"^"===b&&d||(i+="\\"),i+=b}d&&(S=t.substr(g+1),A=this.parse(S,p),i=i.substr(0,m)+"\\["+A[0],c=c||A[1]);for(O=l.pop();O;O=l.pop()){var R=i.slice(O.reStart+O.open.length);this.debug("setting tail",i,O),R=R.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(t,e,r){return r||(r="\\"),e+e+r+"|"})),this.debug("tail=%j\n   %s",R,R,O,i);var C="*"===O.type?"[^/]*?":"?"===O.type?"[^/]":"\\"+O.type;c=!0,i=i.slice(0,O.reStart)+C+"\\("+R}w(),u&&(i+="\\\\");var x=!1;switch(i.charAt(0)){case"[":case".":case"(":x=!0}for(var k=h.length-1;k>-1;k--){var T=h[k],P=i.slice(0,T.reStart),N=i.slice(T.reStart,T.reEnd-8),j=i.slice(T.reEnd-8,T.reEnd),I=i.slice(T.reEnd);j+=I;var D=P.split("(").length-1,M=I;for(_=0;_<D;_++)M=M.replace(/\)[+*?]?/,"");var U="";""===(I=M)&&e!==p&&(U="$"),i=P+N+I+U+j}""!==i&&c&&(i="(?=.)"+i);x&&(i=y+i);if(e===p)return[i,c];if(!c)return function(t){return t.replace(/\\(.)/g,"$1")}(t);var q=r.nocase?"i":"";try{var H=new RegExp("^"+i+"$",q)}catch(t){return new RegExp("$.")}return H._glob=t,H._src=i,H};var p={};l.makeRe=function(t,e){return new h(t,e||{}).makeRe()},h.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?"[^/]*?":e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=e.nocase?"i":"",i=t.map((function(t){return t.map((function(t){return t===o?r:"string"==typeof t?function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(t):t._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(t){this.regexp=!1}return this.regexp},l.match=function(t,e,r){var n=new h(e,r=r||{});return t=t.filter((function(t){return n.match(t)})),n.options.nonull&&!t.length&&t.push(e),t},h.prototype.match=function(t,e){if(void 0===e&&(e=this.partial),this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==n.sep&&(t=t.split(n.sep).join("/")),t=t.split(c),this.debug(this.pattern,"split",t);var o,i,s=this.set;for(this.debug(this.pattern,"set",s),i=t.length-1;i>=0&&!(o=t[i]);i--);for(i=0;i<s.length;i++){var a=s[i],u=t;if(r.matchBase&&1===a.length&&(u=[o]),this.matchOne(u,a,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},h.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,s=0,a=t.length,c=e.length;i<a&&s<c;i++,s++){this.debug("matchOne loop");var u,l=e[s],h=t[i];if(this.debug(e,l,h),!1===l)return!1;if(l===o){this.debug("GLOBSTAR",[e,l,h]);var d=i,f=s+1;if(f===c){for(this.debug("** at the end");i<a;i++)if("."===t[i]||".."===t[i]||!n.dot&&"."===t[i].charAt(0))return!1;return!0}for(;d<a;){var p=t[d];if(this.debug("\nglobstar while",t,d,e,f,p),this.matchOne(t.slice(d),e.slice(f),r))return this.debug("globstar found match!",d,a,p),!0;if("."===p||".."===p||!n.dot&&"."===p.charAt(0)){this.debug("dot detected!",t,d,e,f);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!r||(this.debug("\n>>> no match, partial?",t,d,e,f),d!==a))}if("string"==typeof l?(u=h===l,this.debug("string match",l,h,u)):(u=h.match(l),this.debug("pattern match",l,h,u)),!u)return!1}if(i===a&&s===c)return!0;if(i===a)return r;if(s===c)return i===a-1&&""===t[i];throw new Error("wtf?")}},function(t,e,r){"use strict";function n(t){return"/"===t.charAt(0)}function o(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}t.exports="win32"===process.platform?o:n,t.exports.posix=n,t.exports.win32=o},function(t,e,r){t.exports=r(38)},function(t,e){t.exports=require("events")},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.summary=e.markdownSummary=e.SUMMARY_DOCS_URL=e.SUMMARY_ENV_VAR=void 0;const o=r(4),i=r(0),{access:s,appendFile:a,writeFile:c}=i.promises;e.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY",e.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";const u=new class{constructor(){this._buffer=""}filePath(){return n(this,void 0,void 0,(function*(){if(this._filePath)return this._filePath;const t=process.env[e.SUMMARY_ENV_VAR];if(!t)throw new Error(`Unable to find environment variable for $${e.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield s(t,i.constants.R_OK|i.constants.W_OK)}catch(e){throw new Error(`Unable to access summary file: '${t}'. Check if the file has correct read/write permissions.`)}return this._filePath=t,this._filePath}))}wrap(t,e,r={}){const n=Object.entries(r).map(([t,e])=>` ${t}="${e}"`).join("");return e?`<${t}${n}>${e}</${t}>`:`<${t}${n}>`}write(t){return n(this,void 0,void 0,(function*(){const e=!!(null==t?void 0:t.overwrite),r=yield this.filePath(),n=e?c:a;return yield n(r,this._buffer,{encoding:"utf8"}),this.emptyBuffer()}))}clear(){return n(this,void 0,void 0,(function*(){return this.emptyBuffer().write({overwrite:!0})}))}stringify(){return this._buffer}isEmptyBuffer(){return 0===this._buffer.length}emptyBuffer(){return this._buffer="",this}addRaw(t,e=!1){return this._buffer+=t,e?this.addEOL():this}addEOL(){return this.addRaw(o.EOL)}addCodeBlock(t,e){const r=Object.assign({},e&&{lang:e}),n=this.wrap("pre",this.wrap("code",t),r);return this.addRaw(n).addEOL()}addList(t,e=!1){const r=e?"ol":"ul",n=t.map(t=>this.wrap("li",t)).join(""),o=this.wrap(r,n);return this.addRaw(o).addEOL()}addTable(t){const e=t.map(t=>{const e=t.map(t=>{if("string"==typeof t)return this.wrap("td",t);const{header:e,data:r,colspan:n,rowspan:o}=t,i=e?"th":"td",s=Object.assign(Object.assign({},n&&{colspan:n}),o&&{rowspan:o});return this.wrap(i,r,s)}).join("");return this.wrap("tr",e)}).join(""),r=this.wrap("table",e);return this.addRaw(r).addEOL()}addDetails(t,e){const r=this.wrap("details",this.wrap("summary",t)+e);return this.addRaw(r).addEOL()}addImage(t,e,r){const{width:n,height:o}=r||{},i=Object.assign(Object.assign({},n&&{width:n}),o&&{height:o}),s=this.wrap("img",null,Object.assign({src:t,alt:e},i));return this.addRaw(s).addEOL()}addHeading(t,e){const r="h"+e,n=["h1","h2","h3","h4","h5","h6"].includes(r)?r:"h1",o=this.wrap(n,t);return this.addRaw(o).addEOL()}addSeparator(){const t=this.wrap("hr",null);return this.addRaw(t).addEOL()}addBreak(){const t=this.wrap("br",null);return this.addRaw(t).addEOL()}addQuote(t,e){const r=Object.assign({},e&&{cite:e}),n=this.wrap("blockquote",t,r);return this.addRaw(n).addEOL()}addLink(t,e){const r=this.wrap("a",t,{href:e});return this.addRaw(r).addEOL()}};e.markdownSummary=u,e.summary=u},function(t,e,r){t.exports=v;var n=r(17),o=r(11),i=(o.Minimatch,r(56)),s=r(14).EventEmitter,a=r(1),c=r(6),u=r(12),l=r(58),h=r(18),d=h.setopts,f=h.ownProp,p=r(59),m=(r(3),h.childrenIgnored),g=h.isIgnored,y=r(20);function v(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return l(t,e)}return new b(t,e,r)}v.sync=l;var w=v.GlobSync=l.GlobSync;function b(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new w(t,e)}if(!(this instanceof b))return new b(t,e,r);d(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=y(r),this.on("error",r),this.on("end",(function(t){r(null,t)})));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return s();for(var i=0;i<n;i++)this._process(this.minimatch.set[i],i,!1,s);function s(){--o._processing,o._processing<=0&&o._finish()}}v.glob=v,v.hasMagic=function(t,e){var r=function(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}({},e);r.noprocess=!0;var n=new b(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var o=0;o<n[0].length;o++)if("string"!=typeof n[0][o])return!0;return!1},v.Glob=b,i(b,s),b.prototype._finish=function(){if(c(this instanceof b),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();h.finish(this),this.emit("end",this.found)}},b.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},b.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var o=Object.keys(r),i=this,s=o.length;if(0===s)return e();var a=this.matches[t]=Object.create(null);o.forEach((function(r,o){r=i._makeAbs(r),n.realpath(r,i.realpathCache,(function(n,o){n?"stat"===n.syscall?a[r]=!0:i.emit("error",n):a[o]=!0,0==--s&&(i.matches[t]=a,e())}))}))},b.prototype._mark=function(t){return h.mark(this,t)},b.prototype._makeAbs=function(t){return h.makeAbs(this,t)},b.prototype.abort=function(){this.aborted=!0,this.emit("abort")},b.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},b.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var o=n[e];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}},b.prototype._process=function(t,e,r,n){if(c(this instanceof b),c("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var i,s=0;"string"==typeof t[s];)s++;switch(s){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:i=null;break;default:i=t.slice(0,s).join("/")}var a,l=t.slice(s);null===i?a=".":u(i)||u(t.map((function(t){return"string"==typeof t?t:"[*]"})).join("/"))?(i&&u(i)||(i="/"+i),a=i):a=i;var h=this._makeAbs(a);if(m(this,a))return n();l[0]===o.GLOBSTAR?this._processGlobStar(i,a,h,l,e,r,n):this._processReaddir(i,a,h,l,e,r,n)}},b.prototype._processReaddir=function(t,e,r,n,o,i,s){var a=this;this._readdir(r,i,(function(c,u){return a._processReaddir2(t,e,r,n,o,i,u,s)}))},b.prototype._processReaddir2=function(t,e,r,n,o,i,s,c){if(!s)return c();for(var u=n[0],l=!!this.minimatch.negate,h=u._glob,d=this.dot||"."===h.charAt(0),f=[],p=0;p<s.length;p++){if("."!==(g=s[p]).charAt(0)||d)(l&&!t?!g.match(u):g.match(u))&&f.push(g)}var m=f.length;if(0===m)return c();if(1===n.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(p=0;p<m;p++){var g=f[p];t&&(g="/"!==t?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=a.join(this.root,g)),this._emitMatch(o,g)}return c()}n.shift();for(p=0;p<m;p++){g=f[p];t&&(g="/"!==t?t+"/"+g:t+g),this._process([g].concat(n),o,i,c)}c()},b.prototype._emitMatch=function(t,e){if(!this.aborted&&!g(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=u(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var o=this.statCache[r];o&&this.emit("stat",e,o),this.emit("match",e)}}},b.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,n=p("lstat\0"+t,(function(n,o){if(n&&"ENOENT"===n.code)return e();var i=o&&o.isSymbolicLink();r.symlinks[t]=i,i||!o||o.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())}));n&&r.fs.lstat(t,n)}},b.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=p("readdir\0"+t+"\0"+e,r))){if(e&&!f(this.symlinks,t))return this._readdirInGlobStar(t,r);if(f(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}this.fs.readdir(t,function(t,e,r){return function(n,o){n?t._readdirError(e,n,r):t._readdirEntries(e,o,r)}}(this,t,r))}},b.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var o=e[n];o="/"===t?t+o:t+"/"+o,this.cache[o]=!0}return this.cache[t]=e,r(null,e)}},b.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var o=new Error(e.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=e.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},b.prototype._processGlobStar=function(t,e,r,n,o,i,s){var a=this;this._readdir(r,i,(function(c,u){a._processGlobStar2(t,e,r,n,o,i,u,s)}))},b.prototype._processGlobStar2=function(t,e,r,n,o,i,s,a){if(!s)return a();var c=n.slice(1),u=t?[t]:[],l=u.concat(c);this._process(l,o,!1,a);var h=this.symlinks[r],d=s.length;if(h&&i)return a();for(var f=0;f<d;f++){if("."!==s[f].charAt(0)||this.dot){var p=u.concat(s[f],c);this._process(p,o,!0,a);var m=u.concat(s[f],n);this._process(m,o,!0,a)}}a()},b.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,(function(o,i){n._processSimple2(t,e,o,i,r)}))},b.prototype._processSimple2=function(t,e,r,n,o){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return o();if(t&&u(t)&&!this.nomount){var i=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=a.join(this.root,t):(t=a.resolve(this.root,t),i&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),o()},b.prototype._stat=function(t,e){var r=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&f(this.cache,r)){var o=this.cache[r];if(Array.isArray(o)&&(o="DIR"),!n||"DIR"===o)return e(null,o);if(n&&"FILE"===o)return e()}var i=this.statCache[r];if(void 0!==i){if(!1===i)return e(null,i);var s=i.isDirectory()?"DIR":"FILE";return n&&"FILE"===s?e():e(null,s,i)}var a=this,c=p("stat\0"+r,(function(n,o){if(o&&o.isSymbolicLink())return a.fs.stat(r,(function(n,i){n?a._stat2(t,r,null,o,e):a._stat2(t,r,n,i,e)}));a._stat2(t,r,n,o,e)}));c&&a.fs.lstat(r,c)},b.prototype._stat2=function(t,e,r,n,o){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,o();var i="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return o(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,i&&"FILE"===s?o():o(null,s,n)}},function(t,e,r){t.exports=l,l.realpath=l,l.sync=h,l.realpathSync=h,l.monkeypatch=function(){n.realpath=l,n.realpathSync=h},l.unmonkeypatch=function(){n.realpath=o,n.realpathSync=i};var n=r(0),o=n.realpath,i=n.realpathSync,s=process.version,a=/^v[0-5]\./.test(s),c=r(52);function u(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function l(t,e,r){if(a)return o(t,e,r);"function"==typeof e&&(r=e,e=null),o(t,e,(function(n,o){u(n)?c.realpath(t,e,r):r(n,o)}))}function h(t,e){if(a)return i(t,e);try{return i(t,e)}catch(r){if(u(r))return c.realpathSync(t,e);throw r}}},function(t,e,r){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.setopts=function(t,e,r){r||(r={});if(r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0);t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||o,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(l))}(t,r),t.changedCwd=!1;var s=process.cwd();n(r,"cwd")?(t.cwd=i.resolve(r.cwd),t.changedCwd=t.cwd!==s):t.cwd=s;t.root=r.root||i.resolve(t.cwd,"/"),t.root=i.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"));t.cwdAbs=a(t.cwd)?t.cwd:h(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!1,t.minimatch=new c(e,r),t.options=t.minimatch.options},e.ownProp=n,e.makeAbs=h,e.finish=function(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,o=t.matches.length;n<o;n++){var i=t.matches[n];if(i&&0!==Object.keys(i).length){var s=Object.keys(i);e?r.push.apply(r,s):s.forEach((function(t){r[t]=!0}))}else if(t.nonull){var a=t.minimatch.globSet[n];e?r.push(a):r[a]=!0}}e||(r=Object.keys(r));t.nosort||(r=r.sort(u));if(t.mark){for(n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter((function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[h(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}t.ignore.length&&(r=r.filter((function(e){return!d(t,e)})));t.found=r},e.mark=function(t,e){var r=h(t,e),n=t.cache[r],o=e;if(n){var i="DIR"===n||Array.isArray(n),s="/"===e.slice(-1);if(i&&!s?o+="/":!i&&s&&(o=o.slice(0,-1)),o!==e){var a=h(t,o);t.statCache[a]=t.statCache[r],t.cache[a]=t.cache[r]}}return o},e.isIgnored=d,e.childrenIgnored=function(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return!(!t.gmatcher||!t.gmatcher.match(e))}))};var o=r(0),i=r(1),s=r(11),a=r(12),c=s.Minimatch;function u(t,e){return t.localeCompare(e,"en")}function l(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new c(r,{dot:!0})}return{matcher:new c(t,{dot:!0}),gmatcher:e}}function h(t,e){var r=e;return r="/"===e.charAt(0)?i.join(t.root,e):a(e)||""===e?e:t.changedCwd?i.resolve(t.cwd,e):i.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function d(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))}))}},function(t,e){t.exports=function t(e,r){if(e&&r)return t(e)(r);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){n[t]=e[t]})),n;function n(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),o=t[t.length-1];return"function"==typeof n&&n!==o&&Object.keys(o).forEach((function(t){n[t]=o[t]})),n}}},function(t,e,r){var n=r(19);function o(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function i(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}t.exports=n(o),t.exports.strict=n(i),o.proto=o((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return o(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})}))},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("perf_hooks")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(2);e.StatusReporter=class{constructor(t){this.totalNumberOfFilesToProcess=0,this.processedCount=0,this.largeFiles=new Map,this.totalFileStatus=void 0,this.largeFileStatus=void 0,this.displayFrequencyInMilliseconds=t}setTotalNumberOfFilesToProcess(t){this.totalNumberOfFilesToProcess=t}start(){this.totalFileStatus=setInterval(()=>{const t=this.formatPercentage(this.processedCount,this.totalNumberOfFilesToProcess);n.info(`Total file count: ${this.totalNumberOfFilesToProcess} ---- Processed file #${this.processedCount} (${t.slice(0,t.indexOf(".")+2)}%)`)},this.displayFrequencyInMilliseconds),this.largeFileStatus=setInterval(()=>{for(const t of Array.from(this.largeFiles.values()))n.info(t);this.largeFiles.clear()},1e3)}updateLargeFileStatus(t,e,r){const n=this.formatPercentage(e,r),o=`Uploading ${t} (${n.slice(0,n.indexOf(".")+2)}%)`;this.largeFiles.set(t,o)}stop(){this.totalFileStatus&&clearInterval(this.totalFileStatus),this.largeFileStatus&&clearInterval(this.largeFileStatus)}incrementProcessedCount(){this.processedCount++}formatPercentage(t,e){return(t/e*100).toFixed(4).toString()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(5);e.HttpManager=class{constructor(t,e){if(t<1)throw new Error("There must be at least one client");this.userAgent=e,this.clients=new Array(t).fill(n.createHttpClient(e))}getClient(t){return this.clients[t]}disposeAndReplaceClient(t){this.clients[t].dispose(),this.clients[t]=n.createHttpClient(this.userAgent)}disposeAndReplaceAllClients(){for(const[t]of this.clients.entries())this.disposeAndReplaceClient(t)}}},function(t,e){t.exports=require("zlib")},function(t,e,r){const{upload:n}=r(27),o=r(64);console.log("testing2");(async function(t,e){const r=t("image",!0);e("artifact_name",await n(r))})(o.getInput,o.writeOutput).then(()=>console.log("Uploading finished")).catch(t=>o.fail(t))},function(t,e,r){const n=r(28),o=r(30),i=r(1),s=r(4),a=/[\s><:"|*?/\\]/g,c=t=>t.replace(a,"_"),u=t=>"action_image_artifact_"+c(t);console.error("packageimage"),e.upload=async function(t){const e=await n.packageImage(t,i.join(s.tmpdir(),c(t))),r=u(t);return await o.upload(r,e),r},e.download=async function(t){const e=await o.download(u(t),s.tmpdir()),r=c(t);return await n.loadImage(i.join(e,r)),i.join(e,r)}},function(t,e,r){const{exec:n}=r(29),{existsSync:o}=r(0);console.log("hey3"),e.packageImage=async function(t,e){return await new Promise((t,r)=>{n("docker image ls",{maxBuffer:536870912},(n,o,i)=>{error=n||i,error?r(""+error):t(e)})}),await new Promise((r,o)=>{n(((t,e)=>`docker save ${t} -o ${e}`)(t,e),{maxBuffer:536870912},(t,n,i)=>{error=t||i,error?o("i dunno why "+error):r(e)})})},e.loadImage=async function(t){if(!o(t))throw new Error("Docker load image failed - image input path does not exist: "+t);return await new Promise((e,r)=>{n((t=>"docker load -i "+t)(t),{maxBuffer:536870912},(t,n,o)=>{error=t||o,error?r(error):e()})})}},function(t,e){t.exports=require("child_process")},function(t,e,r){const n=r(31),o=r(1),i=r(0);var s;function a(){return s=s||n.create()}e.upload=async function(t,e,r=0){if(!i.existsSync(e))throw new Error(`Artifact Upload failed: ${t} - File does not exist: ${e}`);if((await a().uploadArtifact(t,[e],o.dirname(e),{retentionDays:r})).failedItems.length>0)throw new Error("Artifact Upload failed: "+t);return t},e.download=async function(t,e){if(!i.existsSync(e))throw new Error(`Artifact Upload failed: ${t} - Directory does not exist: ${e}`);return(await a().downloadArtifact(t,e)).downloadPath}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(32);e.create=function(){return n.DefaultArtifactClient.create()}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(2)),s=r(43),a=r(47),c=r(5),u=r(62),l=r(63),h=r(7),d=r(1);class f{static create(){return new f}uploadArtifact(t,e,r,o){return n(this,void 0,void 0,(function*(){c.checkArtifactName(t);const n=s.getUploadSpecification(t,r,e),u={artifactName:t,artifactItems:[],size:0,failedItems:[]},l=new a.UploadHttpClient;if(0===n.length)i.warning("No files found that can be uploaded");else{const e=yield l.createArtifactInFileContainer(t,o);if(!e.fileContainerResourceUrl)throw i.debug(e.toString()),new Error("No URL provided by the Artifact Service to upload an artifact to");i.debug("Upload Resource URL: "+e.fileContainerResourceUrl);const r=yield l.uploadArtifactToFileContainer(e.fileContainerResourceUrl,n,o);yield l.patchArtifactSize(r.totalSize,t),i.info(`Finished uploading artifact ${t}. Reported size is ${r.uploadSize} bytes. There were ${r.failedItems.length} items that failed to upload`),u.artifactItems=n.map(t=>t.absoluteFilePath),u.size=r.uploadSize,u.failedItems=r.failedItems}return u}))}downloadArtifact(t,e,r){return n(this,void 0,void 0,(function*(){const n=new u.DownloadHttpClient,o=yield n.listArtifacts();if(0===o.count)throw new Error("Unable to find any artifacts for the associated workflow");const s=o.value.find(e=>e.name===t);if(!s)throw new Error("Unable to find an artifact with the name: "+t);const a=yield n.getContainerItems(s.name,s.fileContainerResourceUrl);e||(e=h.getWorkSpaceDirectory()),e=d.normalize(e),e=d.resolve(e);const f=l.getDownloadSpecification(t,a.value,e,(null==r?void 0:r.createArtifactFolder)||!1);return 0===f.filesToDownload.length?i.info("No downloadable files were found for the artifact: "+s.name):(yield c.createDirectoriesForArtifact(f.directoryStructure),i.info("Directory structure has been setup for the artifact"),yield c.createEmptyFilesForArtifact(f.emptyFilesToCreate),yield n.downloadSingleArtifact(f.filesToDownload)),{artifactName:t,downloadPath:f.rootDownloadLocation}}))}downloadAllArtifacts(t){return n(this,void 0,void 0,(function*(){const e=new u.DownloadHttpClient,r=[],n=yield e.listArtifacts();if(0===n.count)return i.info("Unable to find any artifacts for the associated workflow"),r;t||(t=h.getWorkSpaceDirectory()),t=d.normalize(t),t=d.resolve(t);let o=0;for(;o<n.count;){const s=n.value[o];o+=1;const a=yield e.getContainerItems(s.name,s.fileContainerResourceUrl),u=l.getDownloadSpecification(s.name,a.value,t,!0);0===u.filesToDownload.length?i.info("No downloadable files were found for any artifact "+s.name):(yield c.createDirectoriesForArtifact(u.directoryStructure),yield c.createEmptyFilesForArtifact(u.emptyFilesToCreate),yield e.downloadSingleArtifact(u.filesToDownload)),r.push({artifactName:s.name,downloadPath:u.rootDownloadLocation})}return r}))}}e.DefaultArtifactClient=f},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.issue=e.issueCommand=void 0;const s=i(r(4)),a=r(8);function c(t,e,r){const n=new u(t,e,r);process.stdout.write(n.toString()+s.EOL)}e.issueCommand=c,e.issue=function(t,e=""){c(t,{},e)};class u{constructor(t,e,r){t||(t="missing.command"),this.command=t,this.properties=e,this.message=r}toString(){let t="::"+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(const n in this.properties)if(this.properties.hasOwnProperty(n)){const o=this.properties[n];o&&(r?r=!1:t+=",",t+=`${n}=${e=o,a.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}`)}}var e;return t+="::"+function(t){return a.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}(this.message),t}}},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.issueCommand=void 0;const s=i(r(0)),a=i(r(4)),c=r(8);e.issueCommand=function(t,e){const r=process.env["GITHUB_"+t];if(!r)throw new Error("Unable to find environment variable for file command "+t);if(!s.existsSync(r))throw new Error("Missing file at path: "+r);s.appendFileSync(r,`${c.toCommandValue(e)}${a.EOL}`,{encoding:"utf8"})}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.OidcClient=void 0;const o=r(36),i=r(41),s=r(2);class a{static createHttpClient(t=!0,e=10){const r={allowRetries:t,maxRetries:e};return new o.HttpClient("actions/oidc-client",[new i.BearerCredentialHandler(a.getRequestToken())],r)}static getRequestToken(){const t=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return t}static getIDTokenUrl(){const t=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return t}static getCall(t){var e;return n(this,void 0,void 0,(function*(){const r=a.createHttpClient(),n=yield r.getJson(t).catch(t=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${t.statusCode}\n \n        Error Message: ${t.result.message}`)}),o=null===(e=n.result)||void 0===e?void 0:e.value;if(!o)throw new Error("Response json body do not have ID Token field");return o}))}static getIDToken(t){return n(this,void 0,void 0,(function*(){try{let e=a.getIDTokenUrl();if(t){e=`${e}&audience=${encodeURIComponent(t)}`}s.debug("ID token url is "+e);const r=yield a.getCall(e);return s.setSecret(r),r}catch(t){throw new Error("Error message: "+t.message)}}))}}e.OidcClient=a},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e},s=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.HttpClient=e.isHttps=e.HttpClientResponse=e.HttpClientError=e.getProxyUrl=e.MediaTypes=e.Headers=e.HttpCodes=void 0;const a=i(r(9)),c=i(r(10)),u=i(r(37)),l=i(r(13));var h,d,f;!function(t){t[t.OK=200]="OK",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.ResourceMoved=302]="ResourceMoved",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.SwitchProxy=306]="SwitchProxy",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.TooManyRequests=429]="TooManyRequests",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout"}(h=e.HttpCodes||(e.HttpCodes={})),function(t){t.Accept="accept",t.ContentType="content-type"}(d=e.Headers||(e.Headers={})),function(t){t.ApplicationJson="application/json"}(f=e.MediaTypes||(e.MediaTypes={})),e.getProxyUrl=function(t){const e=u.getProxyUrl(new URL(t));return e?e.href:""};const p=[h.MovedPermanently,h.ResourceMoved,h.SeeOther,h.TemporaryRedirect,h.PermanentRedirect],m=[h.BadGateway,h.ServiceUnavailable,h.GatewayTimeout],g=["OPTIONS","GET","DELETE","HEAD"];class y extends Error{constructor(t,e){super(t),this.name="HttpClientError",this.statusCode=e,Object.setPrototypeOf(this,y.prototype)}}e.HttpClientError=y;class v{constructor(t){this.message=t}readBody(){return s(this,void 0,void 0,(function*(){return new Promise(t=>s(this,void 0,void 0,(function*(){let e=Buffer.alloc(0);this.message.on("data",t=>{e=Buffer.concat([e,t])}),this.message.on("end",()=>{t(e.toString())})})))}))}}e.HttpClientResponse=v,e.isHttps=function(t){return"https:"===new URL(t).protocol};e.HttpClient=class{constructor(t,e,r){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=e||[],this.requestOptions=r,r&&(null!=r.ignoreSslError&&(this._ignoreSslError=r.ignoreSslError),this._socketTimeout=r.socketTimeout,null!=r.allowRedirects&&(this._allowRedirects=r.allowRedirects),null!=r.allowRedirectDowngrade&&(this._allowRedirectDowngrade=r.allowRedirectDowngrade),null!=r.maxRedirects&&(this._maxRedirects=Math.max(r.maxRedirects,0)),null!=r.keepAlive&&(this._keepAlive=r.keepAlive),null!=r.allowRetries&&(this._allowRetries=r.allowRetries),null!=r.maxRetries&&(this._maxRetries=r.maxRetries))}options(t,e){return s(this,void 0,void 0,(function*(){return this.request("OPTIONS",t,null,e||{})}))}get(t,e){return s(this,void 0,void 0,(function*(){return this.request("GET",t,null,e||{})}))}del(t,e){return s(this,void 0,void 0,(function*(){return this.request("DELETE",t,null,e||{})}))}post(t,e,r){return s(this,void 0,void 0,(function*(){return this.request("POST",t,e,r||{})}))}patch(t,e,r){return s(this,void 0,void 0,(function*(){return this.request("PATCH",t,e,r||{})}))}put(t,e,r){return s(this,void 0,void 0,(function*(){return this.request("PUT",t,e,r||{})}))}head(t,e){return s(this,void 0,void 0,(function*(){return this.request("HEAD",t,null,e||{})}))}sendStream(t,e,r,n){return s(this,void 0,void 0,(function*(){return this.request(t,e,r,n)}))}getJson(t,e={}){return s(this,void 0,void 0,(function*(){e[d.Accept]=this._getExistingOrDefaultHeader(e,d.Accept,f.ApplicationJson);const r=yield this.get(t,e);return this._processResponse(r,this.requestOptions)}))}postJson(t,e,r={}){return s(this,void 0,void 0,(function*(){const n=JSON.stringify(e,null,2);r[d.Accept]=this._getExistingOrDefaultHeader(r,d.Accept,f.ApplicationJson),r[d.ContentType]=this._getExistingOrDefaultHeader(r,d.ContentType,f.ApplicationJson);const o=yield this.post(t,n,r);return this._processResponse(o,this.requestOptions)}))}putJson(t,e,r={}){return s(this,void 0,void 0,(function*(){const n=JSON.stringify(e,null,2);r[d.Accept]=this._getExistingOrDefaultHeader(r,d.Accept,f.ApplicationJson),r[d.ContentType]=this._getExistingOrDefaultHeader(r,d.ContentType,f.ApplicationJson);const o=yield this.put(t,n,r);return this._processResponse(o,this.requestOptions)}))}patchJson(t,e,r={}){return s(this,void 0,void 0,(function*(){const n=JSON.stringify(e,null,2);r[d.Accept]=this._getExistingOrDefaultHeader(r,d.Accept,f.ApplicationJson),r[d.ContentType]=this._getExistingOrDefaultHeader(r,d.ContentType,f.ApplicationJson);const o=yield this.patch(t,n,r);return this._processResponse(o,this.requestOptions)}))}request(t,e,r,n){return s(this,void 0,void 0,(function*(){if(this._disposed)throw new Error("Client has already been disposed.");const o=new URL(e);let i=this._prepareRequest(t,o,n);const s=this._allowRetries&&g.includes(t)?this._maxRetries+1:1;let a,c=0;do{if(a=yield this.requestRaw(i,r),a&&a.message&&a.message.statusCode===h.Unauthorized){let t;for(const e of this.handlers)if(e.canHandleAuthentication(a)){t=e;break}return t?t.handleAuthentication(this,i,r):a}let e=this._maxRedirects;for(;a.message.statusCode&&p.includes(a.message.statusCode)&&this._allowRedirects&&e>0;){const s=a.message.headers.location;if(!s)break;const c=new URL(s);if("https:"===o.protocol&&o.protocol!==c.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield a.readBody(),c.hostname!==o.hostname)for(const t in n)"authorization"===t.toLowerCase()&&delete n[t];i=this._prepareRequest(t,c,n),a=yield this.requestRaw(i,r),e--}if(!a.message.statusCode||!m.includes(a.message.statusCode))return a;c+=1,c<s&&(yield a.readBody(),yield this._performExponentialBackoff(c))}while(c<s);return a}))}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,e){return s(this,void 0,void 0,(function*(){return new Promise((r,n)=>{this.requestRawWithCallback(t,e,(function(t,e){t?n(t):e?r(e):n(new Error("Unknown error"))}))})}))}requestRawWithCallback(t,e,r){"string"==typeof e&&(t.options.headers||(t.options.headers={}),t.options.headers["Content-Length"]=Buffer.byteLength(e,"utf8"));let n=!1;function o(t,e){n||(n=!0,r(t,e))}const i=t.httpModule.request(t.options,t=>{o(void 0,new v(t))});let s;i.on("socket",t=>{s=t}),i.setTimeout(this._socketTimeout||18e4,()=>{s&&s.end(),o(new Error("Request timeout: "+t.options.path))}),i.on("error",(function(t){o(t)})),e&&"string"==typeof e&&i.write(e,"utf8"),e&&"string"!=typeof e?(e.on("close",(function(){i.end()})),e.pipe(i)):i.end()}getAgent(t){const e=new URL(t);return this._getAgent(e)}_prepareRequest(t,e,r){const n={};n.parsedUrl=e;const o="https:"===n.parsedUrl.protocol;n.httpModule=o?c:a;const i=o?443:80;if(n.options={},n.options.host=n.parsedUrl.hostname,n.options.port=n.parsedUrl.port?parseInt(n.parsedUrl.port):i,n.options.path=(n.parsedUrl.pathname||"")+(n.parsedUrl.search||""),n.options.method=t,n.options.headers=this._mergeHeaders(r),null!=this.userAgent&&(n.options.headers["user-agent"]=this.userAgent),n.options.agent=this._getAgent(n.parsedUrl),this.handlers)for(const t of this.handlers)t.prepareRequest(n.options);return n}_mergeHeaders(t){return this.requestOptions&&this.requestOptions.headers?Object.assign({},w(this.requestOptions.headers),w(t||{})):w(t||{})}_getExistingOrDefaultHeader(t,e,r){let n;return this.requestOptions&&this.requestOptions.headers&&(n=w(this.requestOptions.headers)[e]),t[e]||n||r}_getAgent(t){let e;const r=u.getProxyUrl(t),n=r&&r.hostname;if(this._keepAlive&&n&&(e=this._proxyAgent),this._keepAlive&&!n&&(e=this._agent),e)return e;const o="https:"===t.protocol;let i=100;if(this.requestOptions&&(i=this.requestOptions.maxSockets||a.globalAgent.maxSockets),r&&r.hostname){const t={maxSockets:i,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(r.username||r.password)&&{proxyAuth:`${r.username}:${r.password}`}),{host:r.hostname,port:r.port})};let n;const s="https:"===r.protocol;n=o?s?l.httpsOverHttps:l.httpsOverHttp:s?l.httpOverHttps:l.httpOverHttp,e=n(t),this._proxyAgent=e}if(this._keepAlive&&!e){const t={keepAlive:this._keepAlive,maxSockets:i};e=o?new c.Agent(t):new a.Agent(t),this._agent=e}return e||(e=o?c.globalAgent:a.globalAgent),o&&this._ignoreSslError&&(e.options=Object.assign(e.options||{},{rejectUnauthorized:!1})),e}_performExponentialBackoff(t){return s(this,void 0,void 0,(function*(){t=Math.min(10,t);const e=5*Math.pow(2,t);return new Promise(t=>setTimeout(()=>t(),e))}))}_processResponse(t,e){return s(this,void 0,void 0,(function*(){return new Promise((r,n)=>s(this,void 0,void 0,(function*(){const o=t.message.statusCode||0,i={statusCode:o,result:null,headers:{}};let s,a;o===h.NotFound&&r(i);try{a=yield t.readBody(),a&&a.length>0&&(s=e&&e.deserializeDates?JSON.parse(a,(function(t,e){if("string"==typeof e){const t=new Date(e);if(!isNaN(t.valueOf()))return t}return e})):JSON.parse(a),i.result=s),i.headers=t.message.headers}catch(t){}if(o>299){let t;t=s&&s.message?s.message:a&&a.length>0?a:`Failed request: (${o})`;const e=new y(t,o);e.result=i.result,n(e)}else r(i)})))}))}};const w=t=>Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{})},function(t,e,r){"use strict";function n(t){if(!t.hostname)return!1;const e=process.env.no_proxy||process.env.NO_PROXY||"";if(!e)return!1;let r;t.port?r=Number(t.port):"http:"===t.protocol?r=80:"https:"===t.protocol&&(r=443);const n=[t.hostname.toUpperCase()];"number"==typeof r&&n.push(`${n[0]}:${r}`);for(const t of e.split(",").map(t=>t.trim().toUpperCase()).filter(t=>t))if(n.some(e=>e===t))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.checkBypass=e.getProxyUrl=void 0,e.getProxyUrl=function(t){const e="https:"===t.protocol;if(n(t))return;const r=e?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY;return r?new URL(r):void 0},e.checkBypass=n},function(t,e,r){"use strict";r(39);var n,o=r(40),i=r(9),s=r(10),a=r(14),c=(r(6),r(3));function u(t){var e=this;e.options=t||{},e.proxyOptions=e.options.proxy||{},e.maxSockets=e.options.maxSockets||i.Agent.defaultMaxSockets,e.requests=[],e.sockets=[],e.on("free",(function(t,r,n,o){for(var i=h(r,n,o),s=0,a=e.requests.length;s<a;++s){var c=e.requests[s];if(c.host===i.host&&c.port===i.port)return e.requests.splice(s,1),void c.request.onSocket(t)}t.destroy(),e.removeSocket(t)}))}function l(t,e){var r=this;u.prototype.createSocket.call(r,t,(function(n){var i=t.request.getHeader("host"),s=d({},r.options,{socket:n,servername:i?i.replace(/:.*$/,""):t.host}),a=o.connect(0,s);r.sockets[r.sockets.indexOf(n)]=a,e(a)}))}function h(t,e,r){return"string"==typeof t?{host:t,port:e,localAddress:r}:t}function d(t){for(var e=1,r=arguments.length;e<r;++e){var n=arguments[e];if("object"==typeof n)for(var o=Object.keys(n),i=0,s=o.length;i<s;++i){var a=o[i];void 0!==n[a]&&(t[a]=n[a])}}return t}e.httpOverHttp=function(t){var e=new u(t);return e.request=i.request,e},e.httpsOverHttp=function(t){var e=new u(t);return e.request=i.request,e.createSocket=l,e.defaultPort=443,e},e.httpOverHttps=function(t){var e=new u(t);return e.request=s.request,e},e.httpsOverHttps=function(t){var e=new u(t);return e.request=s.request,e.createSocket=l,e.defaultPort=443,e},c.inherits(u,a.EventEmitter),u.prototype.addRequest=function(t,e,r,n){var o=this,i=d({request:t},o.options,h(e,r,n));o.sockets.length>=this.maxSockets?o.requests.push(i):o.createSocket(i,(function(e){function r(){o.emit("free",e,i)}function n(t){o.removeSocket(e),e.removeListener("free",r),e.removeListener("close",n),e.removeListener("agentRemove",n)}e.on("free",r),e.on("close",n),e.on("agentRemove",n),t.onSocket(e)}))},u.prototype.createSocket=function(t,e){var r=this,o={};r.sockets.push(o);var i=d({},r.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(i.localAddress=t.localAddress),i.proxyAuth&&(i.headers=i.headers||{},i.headers["Proxy-Authorization"]="Basic "+new Buffer(i.proxyAuth).toString("base64")),n("making CONNECT request");var s=r.request(i);function a(i,a,c){var u;return s.removeAllListeners(),a.removeAllListeners(),200!==i.statusCode?(n("tunneling socket could not be established, statusCode=%d",i.statusCode),a.destroy(),(u=new Error("tunneling socket could not be established, statusCode="+i.statusCode)).code="ECONNRESET",t.request.emit("error",u),void r.removeSocket(o)):c.length>0?(n("got illegal response body from proxy"),a.destroy(),(u=new Error("got illegal response body from proxy")).code="ECONNRESET",t.request.emit("error",u),void r.removeSocket(o)):(n("tunneling connection has established"),r.sockets[r.sockets.indexOf(o)]=a,e(a))}s.useChunkedEncodingByDefault=!1,s.once("response",(function(t){t.upgrade=!0})),s.once("upgrade",(function(t,e,r){process.nextTick((function(){a(t,e,r)}))})),s.once("connect",a),s.once("error",(function(e){s.removeAllListeners(),n("tunneling socket could not be established, cause=%s\n",e.message,e.stack);var i=new Error("tunneling socket could not be established, cause="+e.message);i.code="ECONNRESET",t.request.emit("error",i),r.removeSocket(o)})),s.end()},u.prototype.removeSocket=function(t){var e=this.sockets.indexOf(t);if(-1!==e){this.sockets.splice(e,1);var r=this.requests.shift();r&&this.createSocket(r,(function(t){r.request.onSocket(t)}))}},n=process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?function(){var t=Array.prototype.slice.call(arguments);"string"==typeof t[0]?t[0]="TUNNEL: "+t[0]:t.unshift("TUNNEL:"),console.error.apply(console,t)}:function(){},e.debug=n},function(t,e){t.exports=require("net")},function(t,e){t.exports=require("tls")},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PersonalAccessTokenCredentialHandler=e.BearerCredentialHandler=e.BasicCredentialHandler=void 0;e.BasicCredentialHandler=class{constructor(t,e){this.username=t,this.password=e}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization="Basic "+Buffer.from(`${this.username}:${this.password}`).toString("base64")}canHandleAuthentication(){return!1}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}};e.BearerCredentialHandler=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization="Bearer "+this.token}canHandleAuthentication(){return!1}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}};e.PersonalAccessTokenCredentialHandler=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(){return!1}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.toPlatformPath=e.toWin32Path=e.toPosixPath=void 0;const s=i(r(1));e.toPosixPath=function(t){return t.replace(/[\\]/g,"/")},e.toWin32Path=function(t){return t.replace(/[/]/g,"\\")},e.toPlatformPath=function(t){return t.replace(/[/\\]/g,s.sep)}},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(r(0)),i=r(2),s=r(1),a=r(5);e.getUploadSpecification=function(t,e,r){a.checkArtifactName(t);const n=[];if(!o.existsSync(e))throw new Error(`Provided rootDirectory ${e} does not exist`);if(!o.lstatSync(e).isDirectory())throw new Error(`Provided rootDirectory ${e} is not a valid directory`);e=s.normalize(e),e=s.resolve(e);for(let c of r){if(!o.existsSync(c))throw new Error(`File ${c} does not exist`);if(o.lstatSync(c).isDirectory())i.debug(`Removing ${c} from rawSearchResults because it is a directory`);else{if(c=s.normalize(c),c=s.resolve(c),!c.startsWith(e))throw new Error(`The rootDirectory: ${e} is not a parent directory of the file: ${c}`);const r=c.replace(e,"");a.checkArtifactFilePath(r),n.push({absoluteFilePath:c,uploadFilePath:s.join(t,r)})}}return n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(9),o=r(10),i=r(45);let s;var a,c,u;!function(t){t[t.OK=200]="OK",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.ResourceMoved=302]="ResourceMoved",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.SwitchProxy=306]="SwitchProxy",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.TooManyRequests=429]="TooManyRequests",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout"}(a=e.HttpCodes||(e.HttpCodes={})),function(t){t.Accept="accept",t.ContentType="content-type"}(c=e.Headers||(e.Headers={})),function(t){t.ApplicationJson="application/json"}(u=e.MediaTypes||(e.MediaTypes={})),e.getProxyUrl=function(t){let e=i.getProxyUrl(new URL(t));return e?e.href:""};const l=[a.MovedPermanently,a.ResourceMoved,a.SeeOther,a.TemporaryRedirect,a.PermanentRedirect],h=[a.BadGateway,a.ServiceUnavailable,a.GatewayTimeout],d=["OPTIONS","GET","DELETE","HEAD"];class f extends Error{constructor(t,e){super(t),this.name="HttpClientError",this.statusCode=e,Object.setPrototypeOf(this,f.prototype)}}e.HttpClientError=f;class p{constructor(t){this.message=t}readBody(){return new Promise(async(t,e)=>{let r=Buffer.alloc(0);this.message.on("data",t=>{r=Buffer.concat([r,t])}),this.message.on("end",()=>{t(r.toString())})})}}e.HttpClientResponse=p,e.isHttps=function(t){return"https:"===new URL(t).protocol};class m{constructor(t,e,r){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=e||[],this.requestOptions=r,r&&(null!=r.ignoreSslError&&(this._ignoreSslError=r.ignoreSslError),this._socketTimeout=r.socketTimeout,null!=r.allowRedirects&&(this._allowRedirects=r.allowRedirects),null!=r.allowRedirectDowngrade&&(this._allowRedirectDowngrade=r.allowRedirectDowngrade),null!=r.maxRedirects&&(this._maxRedirects=Math.max(r.maxRedirects,0)),null!=r.keepAlive&&(this._keepAlive=r.keepAlive),null!=r.allowRetries&&(this._allowRetries=r.allowRetries),null!=r.maxRetries&&(this._maxRetries=r.maxRetries))}options(t,e){return this.request("OPTIONS",t,null,e||{})}get(t,e){return this.request("GET",t,null,e||{})}del(t,e){return this.request("DELETE",t,null,e||{})}post(t,e,r){return this.request("POST",t,e,r||{})}patch(t,e,r){return this.request("PATCH",t,e,r||{})}put(t,e,r){return this.request("PUT",t,e,r||{})}head(t,e){return this.request("HEAD",t,null,e||{})}sendStream(t,e,r,n){return this.request(t,e,r,n)}async getJson(t,e={}){e[c.Accept]=this._getExistingOrDefaultHeader(e,c.Accept,u.ApplicationJson);let r=await this.get(t,e);return this._processResponse(r,this.requestOptions)}async postJson(t,e,r={}){let n=JSON.stringify(e,null,2);r[c.Accept]=this._getExistingOrDefaultHeader(r,c.Accept,u.ApplicationJson),r[c.ContentType]=this._getExistingOrDefaultHeader(r,c.ContentType,u.ApplicationJson);let o=await this.post(t,n,r);return this._processResponse(o,this.requestOptions)}async putJson(t,e,r={}){let n=JSON.stringify(e,null,2);r[c.Accept]=this._getExistingOrDefaultHeader(r,c.Accept,u.ApplicationJson),r[c.ContentType]=this._getExistingOrDefaultHeader(r,c.ContentType,u.ApplicationJson);let o=await this.put(t,n,r);return this._processResponse(o,this.requestOptions)}async patchJson(t,e,r={}){let n=JSON.stringify(e,null,2);r[c.Accept]=this._getExistingOrDefaultHeader(r,c.Accept,u.ApplicationJson),r[c.ContentType]=this._getExistingOrDefaultHeader(r,c.ContentType,u.ApplicationJson);let o=await this.patch(t,n,r);return this._processResponse(o,this.requestOptions)}async request(t,e,r,n){if(this._disposed)throw new Error("Client has already been disposed.");let o,i=new URL(e),s=this._prepareRequest(t,i,n),c=this._allowRetries&&-1!=d.indexOf(t)?this._maxRetries+1:1,u=0;for(;u<c;){if(o=await this.requestRaw(s,r),o&&o.message&&o.message.statusCode===a.Unauthorized){let t;for(let e=0;e<this.handlers.length;e++)if(this.handlers[e].canHandleAuthentication(o)){t=this.handlers[e];break}return t?t.handleAuthentication(this,s,r):o}let e=this._maxRedirects;for(;-1!=l.indexOf(o.message.statusCode)&&this._allowRedirects&&e>0;){const a=o.message.headers.location;if(!a)break;let c=new URL(a);if("https:"==i.protocol&&i.protocol!=c.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(await o.readBody(),c.hostname!==i.hostname)for(let t in n)"authorization"===t.toLowerCase()&&delete n[t];s=this._prepareRequest(t,c,n),o=await this.requestRaw(s,r),e--}if(-1==h.indexOf(o.message.statusCode))return o;u+=1,u<c&&(await o.readBody(),await this._performExponentialBackoff(u))}return o}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,e){return new Promise((r,n)=>{this.requestRawWithCallback(t,e,(function(t,e){t&&n(t),r(e)}))})}requestRawWithCallback(t,e,r){let n;"string"==typeof e&&(t.options.headers["Content-Length"]=Buffer.byteLength(e,"utf8"));let o=!1,i=(t,e)=>{o||(o=!0,r(t,e))},s=t.httpModule.request(t.options,t=>{let e=new p(t);i(null,e)});s.on("socket",t=>{n=t}),s.setTimeout(this._socketTimeout||18e4,()=>{n&&n.end(),i(new Error("Request timeout: "+t.options.path),null)}),s.on("error",(function(t){i(t,null)})),e&&"string"==typeof e&&s.write(e,"utf8"),e&&"string"!=typeof e?(e.on("close",(function(){s.end()})),e.pipe(s)):s.end()}getAgent(t){let e=new URL(t);return this._getAgent(e)}_prepareRequest(t,e,r){const i={};i.parsedUrl=e;const s="https:"===i.parsedUrl.protocol;i.httpModule=s?o:n;const a=s?443:80;return i.options={},i.options.host=i.parsedUrl.hostname,i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):a,i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||""),i.options.method=t,i.options.headers=this._mergeHeaders(r),null!=this.userAgent&&(i.options.headers["user-agent"]=this.userAgent),i.options.agent=this._getAgent(i.parsedUrl),this.handlers&&this.handlers.forEach(t=>{t.prepareRequest(i.options)}),i}_mergeHeaders(t){const e=t=>Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{});return this.requestOptions&&this.requestOptions.headers?Object.assign({},e(this.requestOptions.headers),e(t)):e(t||{})}_getExistingOrDefaultHeader(t,e,r){let n;var o;return this.requestOptions&&this.requestOptions.headers&&(n=(o=this.requestOptions.headers,Object.keys(o).reduce((t,e)=>(t[e.toLowerCase()]=o[e],t),{}))[e]),t[e]||n||r}_getAgent(t){let e,a=i.getProxyUrl(t),c=a&&a.hostname;if(this._keepAlive&&c&&(e=this._proxyAgent),this._keepAlive&&!c&&(e=this._agent),e)return e;const u="https:"===t.protocol;let l=100;if(this.requestOptions&&(l=this.requestOptions.maxSockets||n.globalAgent.maxSockets),c){s||(s=r(13));const t={maxSockets:l,keepAlive:this._keepAlive,proxy:{...(a.username||a.password)&&{proxyAuth:`${a.username}:${a.password}`},host:a.hostname,port:a.port}};let n;const o="https:"===a.protocol;n=u?o?s.httpsOverHttps:s.httpsOverHttp:o?s.httpOverHttps:s.httpOverHttp,e=n(t),this._proxyAgent=e}if(this._keepAlive&&!e){const t={keepAlive:this._keepAlive,maxSockets:l};e=u?new o.Agent(t):new n.Agent(t),this._agent=e}return e||(e=u?o.globalAgent:n.globalAgent),u&&this._ignoreSslError&&(e.options=Object.assign(e.options||{},{rejectUnauthorized:!1})),e}_performExponentialBackoff(t){t=Math.min(10,t);const e=5*Math.pow(2,t);return new Promise(t=>setTimeout(()=>t(),e))}static dateTimeDeserializer(t,e){if("string"==typeof e){let t=new Date(e);if(!isNaN(t.valueOf()))return t}return e}async _processResponse(t,e){return new Promise(async(r,n)=>{const o=t.message.statusCode,i={statusCode:o,result:null,headers:{}};let s,c;o==a.NotFound&&r(i);try{c=await t.readBody(),c&&c.length>0&&(s=e&&e.deserializeDates?JSON.parse(c,m.dateTimeDeserializer):JSON.parse(c),i.result=s),i.headers=t.message.headers}catch(t){}if(o>299){let t;t=s&&s.message?s.message:c&&c.length>0?c:"Failed request: ("+o+")";let e=new f(t,o);e.result=i.result,n(e)}else r(i)})}}e.HttpClient=m},function(t,e,r){"use strict";function n(t){if(!t.hostname)return!1;let e,r=process.env.no_proxy||process.env.NO_PROXY||"";if(!r)return!1;t.port?e=Number(t.port):"http:"===t.protocol?e=80:"https:"===t.protocol&&(e=443);let n=[t.hostname.toUpperCase()];"number"==typeof e&&n.push(`${n[0]}:${e}`);for(let t of r.split(",").map(t=>t.trim().toUpperCase()).filter(t=>t))if(n.some(e=>e===t))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.getProxyUrl=function(t){let e,r,o="https:"===t.protocol;return n(t)||(r=o?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY,r&&(e=new URL(r))),e},e.checkBypass=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BasicCredentialHandler=class{constructor(t,e){this.username=t,this.password=e}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,e,r){return null}};e.BearerCredentialHandler=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Bearer "+this.token}canHandleAuthentication(t){return!1}handleAuthentication(t,e,r){return null}};e.PersonalAccessTokenCredentialHandler=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,e,r){return null}}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(0)),s=o(r(2)),a=o(r(48)),c=o(r(60)),u=r(5),l=r(7),h=r(3),d=r(21),f=r(22),p=r(23),m=r(24),g=r(61),y=h.promisify(i.stat);e.UploadHttpClient=class{constructor(){this.uploadHttpManager=new m.HttpManager(l.getUploadFileConcurrency(),"@actions/artifact-upload"),this.statusReporter=new p.StatusReporter(1e4)}createArtifactInFileContainer(t,e){return n(this,void 0,void 0,(function*(){const r={Type:"actions_storage",Name:t};if(e&&e.retentionDays){const t=l.getRetentionDays();r.RetentionDays=u.getProperRetention(e.retentionDays,t)}const n=JSON.stringify(r,null,2),o=u.getArtifactUrl(),i=this.uploadHttpManager.getClient(0),s=u.getUploadHeaders("application/json",!1),a=yield i.post(o,n,s),c=yield a.readBody();if(u.isSuccessStatusCode(a.message.statusCode)&&c)return JSON.parse(c);throw u.isForbiddenStatusCode(a.message.statusCode)?new Error("Artifact storage quota has been hit. Unable to upload any new artifacts"):(u.displayHttpDiagnostics(a),new Error(`Unable to create a container for the artifact ${t} at ${o}`))}))}uploadArtifactToFileContainer(t,e,r){return n(this,void 0,void 0,(function*(){const o=l.getUploadFileConcurrency(),i=l.getUploadChunkSize();s.debug(`File Concurrency: ${o}, and Chunk Size: ${i}`);const a=[];let c=!0;r&&!1===r.continueOnError&&(c=!1);for(const r of e){const e=new d.URL(t);e.searchParams.append("itemPath",r.uploadFilePath),a.push({file:r.absoluteFilePath,resourceUrl:e.toString(),maxChunkSize:i,continueOnError:c})}const u=[...new Array(o).keys()],h=[];let p=0,m=0,g=0,y=0,v=!1;return this.statusReporter.setTotalNumberOfFilesToProcess(e.length),this.statusReporter.start(),yield Promise.all(u.map(t=>n(this,void 0,void 0,(function*(){for(;p<e.length;){const r=a[p];if(p+=1,v){h.push(r.file);continue}const n=f.performance.now(),o=yield this.uploadFileAsync(t,r);s.isDebug()&&s.debug(`File: ${++m}/${e.length}. ${r.file} took ${(f.performance.now()-n).toFixed(3)} milliseconds to finish upload`),g+=o.successfulUploadSize,y+=o.totalSize,!1===o.isSuccess&&(h.push(r.file),c||(s.error("aborting artifact upload"),v=!0)),this.statusReporter.incrementProcessedCount()}})))),this.statusReporter.stop(),this.uploadHttpManager.disposeAndReplaceAllClients(),s.info(`Total size of all the files uploaded is ${g} bytes`),{uploadSize:g,totalSize:y,failedItems:h}}))}uploadFileAsync(t,e){return n(this,void 0,void 0,(function*(){const r=(yield y(e.file)).size;let n=0,o=!0,u=0,l=0,h=!0;if(r<65536){const n=yield g.createGZipFileInBuffer(e.file);let a;r<n.byteLength?(a=()=>i.createReadStream(e.file),h=!1,l=r):(a=()=>{const t=new c.PassThrough;return t.end(n),t},l=n.byteLength);return(yield this.uploadChunk(t,e.resourceUrl,a,0,l-1,l,h,r))||(o=!1,u+=l,s.warning(`Aborting upload for ${e.file} due to failure`)),{isSuccess:o,successfulUploadSize:l-u,totalSize:r}}{const c=yield a.file();l=yield g.createGZipFileOnDisk(e.file,c.path);let d=c.path;r<l&&(l=r,d=e.file,h=!1);let f=!1;for(;n<l;){const a=Math.min(l-n,e.maxChunkSize);l>104857600&&this.statusReporter.updateLargeFileStatus(e.file,n,l);const c=n,p=n+a-1;if(n+=e.maxChunkSize,f){u+=a;continue}(yield this.uploadChunk(t,e.resourceUrl,()=>i.createReadStream(d,{start:c,end:p,autoClose:!1}),c,p,l,h,r))||(o=!1,u+=a,s.warning(`Aborting upload for ${e.file} due to failure`),f=!0)}return yield c.cleanup(),{isSuccess:o,successfulUploadSize:l-u,totalSize:r}}}))}uploadChunk(t,e,r,o,i,a,c,h){return n(this,void 0,void 0,(function*(){const d=u.getUploadHeaders("application/octet-stream",!0,c,h,i-o+1,u.getContentRange(o,i,a)),f=()=>n(this,void 0,void 0,(function*(){const n=this.uploadHttpManager.getClient(t);return yield n.sendStream("PUT",e,r(),d)}));let p=0;const m=l.getRetryLimit(),g=t=>(p++,p>m&&(t&&u.displayHttpDiagnostics(t),s.info(`Retry limit has been reached for chunk at offset ${o} to ${e}`),!0)),y=e=>n(this,void 0,void 0,(function*(){if(this.uploadHttpManager.disposeAndReplaceClient(t),e)s.info(`Backoff due to too many requests, retry #${p}. Waiting for ${e} milliseconds before continuing the upload`),yield new Promise(t=>setTimeout(t,e));else{const t=u.getExponentialRetryTimeInMilliseconds(p);s.info(`Exponential backoff for retry #${p}. Waiting for ${t} milliseconds before continuing the upload at offset ${o}`),yield new Promise(e=>setTimeout(e,t))}s.info(`Finished backoff for retry #${p}, continuing with upload`)}));for(;p<=m;){let r;try{r=yield f()}catch(e){if(s.info(`An error has been caught http-client index ${t}, retrying the upload`),console.log(e),g())return!1;yield y();continue}if(yield r.readBody(),u.isSuccessStatusCode(r.message.statusCode))return!0;if(!u.isRetryableStatusCode(r.message.statusCode))return s.error("Unexpected response. Unable to upload chunk to "+e),u.displayHttpDiagnostics(r),!1;if(s.info(`A ${r.message.statusCode} status code has been received, will attempt to retry the upload`),g(r))return!1;u.isThrottledStatusCode(r.message.statusCode)?yield y(u.tryGetRetryAfterValueTimeInMilliseconds(r.message.headers)):yield y()}return!1}))}patchArtifactSize(t,e){return n(this,void 0,void 0,(function*(){const r=u.getUploadHeaders("application/json",!1),n=new d.URL(u.getArtifactUrl());n.searchParams.append("artifactName",e);const o={Size:t},i=JSON.stringify(o,null,2);s.debug("URL is "+n.toString());const a=this.uploadHttpManager.getClient(0),c=yield a.patch(n.toString(),i,r),l=yield c.readBody();if(!u.isSuccessStatusCode(c.message.statusCode))throw 404===c.message.statusCode?new Error(`An Artifact with the name ${e} was not found`):(u.displayHttpDiagnostics(c),s.info(l),new Error(`Unable to finish uploading artifact ${e} to ${n}`));s.debug(`Artifact ${e} has been successfully uploaded, total size in bytes: ${t}`)}))}}},function(t,e,r){const{promisify:n}=r(3),o=r(49);t.exports.fileSync=o.fileSync;const i=n((t,e)=>o.file(t,(t,r,o,i)=>t?e(t):e(void 0,{path:r,fd:o,cleanup:n(i)})));t.exports.file=async t=>i(t),t.exports.withFile=async function(e,r){const{path:n,fd:o,cleanup:i}=await t.exports.file(r);try{return await e({path:n,fd:o})}finally{await i()}},t.exports.dirSync=o.dirSync;const s=n((t,e)=>o.dir(t,(t,r,o)=>t?e(t):e(void 0,{path:r,cleanup:n(o)})));t.exports.dir=async t=>s(t),t.exports.withDir=async function(e,r){const{path:n,cleanup:o}=await t.exports.dir(r);try{return await e({path:n})}finally{await o()}},t.exports.tmpNameSync=o.tmpNameSync,t.exports.tmpName=n(o.tmpName),t.exports.tmpdir=o.tmpdir,t.exports.setGracefulCleanup=o.setGracefulCleanup},function(t,e,r){
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
const n=r(0),o=r(4),i=r(1),s=r(50),a=n.constants&&o.constants?{fs:n.constants,os:o.constants}:process.binding("constants"),c=r(51),u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=/XXXXXX/,h=(a.O_CREAT||a.fs.O_CREAT)|(a.O_EXCL||a.fs.O_EXCL)|(a.O_RDWR||a.fs.O_RDWR),d=a.EBADF||a.os.errno.EBADF,f=a.ENOENT||a.os.errno.ENOENT,p=[];var m=!1;function g(t){var e=[],r=null;try{r=s.randomBytes(t)}catch(e){r=s.pseudoRandomBytes(t)}for(var n=0;n<t;n++)e.push(u[r[n]%u.length]);return e.join("")}function y(t,e){return"function"==typeof t?[{},t]:void 0===t?[{},e]:[t,e]}function v(t){const e=N();if(P(t.dir)&&P(e))throw new Error("No tmp dir specified");if(!P(t.name))return i.join(t.dir||e,t.name);if(t.template){var r=t.template;return i.basename(r)===r&&(r=i.join(t.dir||e,r)),r.replace(l,g(6))}const n=[P(t.prefix)?"tmp-":t.prefix,process.pid,g(12),t.postfix?t.postfix:""].join("");return i.join(t.dir||e,n)}function w(t,e){var r=y(t,e),o=r[0],i=r[1],s=P(o.name)?o.tries||3:1;return isNaN(s)||s<0?i(new Error("Invalid tries")):o.template&&!o.template.match(l)?i(new Error("Invalid template provided")):void function t(){try{const e=v(o);n.stat(e,(function(r){if(!r)return s-- >0?t():i(new Error("Could not get a unique tmp filename, max tries reached "+e));i(null,e)}))}catch(t){i(t)}}()}function b(t){var e=y(t)[0],r=P(e.name)?e.tries||3:1;if(isNaN(r)||r<0)throw new Error("Invalid tries");if(e.template&&!e.template.match(l))throw new Error("Invalid template provided");do{const t=v(e);try{n.statSync(t)}catch(e){return t}}while(r-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function _(t,e){const r=function(t){if(t&&!k(t))return e(t);e()};0<=t[0]?n.close(t[0],(function(e){n.unlink(t[1],r)})):n.unlink(t[1],r)}function E(t){try{0<=t[0]&&n.closeSync(t[0])}catch(t){if(!function(t){return T(t,-d,"EBADF")}(t)&&!k(t))throw t}finally{try{n.unlinkSync(t[1])}catch(t){if(!k(t))throw t}}}function O(t,e,r){const n=C(E,[e,t]),o=C(_,[e,t],n);return r.keep||p.unshift(n),o}function S(t,e){c(t,e)}function A(t,e){try{return e(null,c.sync(t))}catch(t){return e(t)}}function R(t,e){const r=e.unsafeCleanup?S:n.rmdir.bind(n),o=C(e.unsafeCleanup?A:n.rmdirSync.bind(n),t),i=C(r,t,o);return e.keep||p.unshift(o),i}function C(t,e,r){var n=!1;return function o(i){if(i=i||function(){},n)return i(new Error("cleanup callback has already been called"));{const s=r||o,a=p.indexOf(s);if(a>=0&&p.splice(a,1),n=!0,1!==t.length)return t(e,i);try{return t(e),i(null)}catch(t){return i(t)}}}}function x(){if(m)for(;p.length;)try{p[0]()}catch(t){}}function k(t){return T(t,-f,"ENOENT")}function T(t,e,r){return t.code===e||t.code===r}function P(t){return null==t||!t.trim()}function N(){return o.tmpdir()}!function(){const t=process.listeners("exit"),e=[];for(let n=0,o=t.length;n<o;n++){const o=t[n];("_tmp$safe_listener"===o.name||("_exit"===(r=o).name||"_uncaughtExceptionThrown"===r.name)&&r.toString().indexOf("_garbageCollector();")>-1)&&("_uncaughtExceptionThrown"!==o.name&&e.push(o),process.removeListener("exit",o))}var r;process.addListener("exit",(function(t){for(let r=0,n=e.length;r<n;r++)try{e[r](t)}catch(t){}x()}))}(),function(){const t=process.listeners("SIGINT"),e=[];for(let r=0,n=t.length;r<n;r++){const n=t[r];"_tmp$sigint_listener"===n.name&&(e.push(n),process.removeListener("SIGINT",n))}process.on("SIGINT",(function(t){for(let t=0,r=e.length;t<r;t++)try{e[t](!1)}catch(t){}try{x()}finally{t&&process.exit(0)}}))}(),Object.defineProperty(t.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return N()}}),t.exports.dir=function(t,e){var r=y(t,e),o=r[0],i=r[1];w(o,(function(t,e){if(t)return i(t);n.mkdir(e,o.mode||448,(function(t){if(t)return i(t);i(null,e,R(e,o))}))}))},t.exports.dirSync=function(t){var e=y(t)[0];const r=b(e);return n.mkdirSync(r,e.mode||448),{name:r,removeCallback:R(r,e)}},t.exports.file=function(t,e){var r=y(t,e),o=r[0],i=r[1];w(o,(function(t,e){if(t)return i(t);n.open(e,h,o.mode||384,(function(t,r){return t?i(t):o.discardDescriptor?n.close(r,(function(t){if(t){try{n.unlinkSync(e)}catch(e){k(e)||(t=e)}return i(t)}i(null,e,void 0,O(e,-1,o))})):o.detachDescriptor?i(null,e,r,O(e,-1,o)):void i(null,e,r,O(e,r,o))}))}))},t.exports.fileSync=function(t){var e=y(t)[0];const r=e.discardDescriptor||e.detachDescriptor,o=b(e);var i=n.openSync(o,h,e.mode||384);return e.discardDescriptor&&(n.closeSync(i),i=void 0),{name:o,fd:i,removeCallback:O(o,r?-1:i,e)}},t.exports.tmpName=w,t.exports.tmpNameSync=b,t.exports.setGracefulCleanup=function(){m=!0}},function(t,e){t.exports=require("crypto")},function(t,e,r){t.exports=d,d.sync=y;var n=r(6),o=r(1),i=r(0),s=void 0;try{s=r(16)}catch(t){}var a=parseInt("666",8),c={nosort:!0,silent:!0},u=0,l="win32"===process.platform;function h(t){if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((function(e){t[e]=t[e]||i[e],t[e+="Sync"]=t[e]||i[e]})),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,!1===t.glob&&(t.disableGlob=!0),!0!==t.disableGlob&&void 0===s)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||c}function d(t,e,r){"function"==typeof e&&(r=e,e={}),n(t,"rimraf: missing path"),n.equal(typeof t,"string","rimraf: path should be a string"),n.equal(typeof r,"function","rimraf: callback function required"),n(e,"rimraf: invalid options argument provided"),n.equal(typeof e,"object","rimraf: options should be object"),h(e);var o=0,i=null,a=0;if(e.disableGlob||!s.hasMagic(t))return c(null,[t]);function c(t,n){return t?r(t):0===(a=n.length)?r():void n.forEach((function(t){f(t,e,(function n(s){if(s){if(("EBUSY"===s.code||"ENOTEMPTY"===s.code||"EPERM"===s.code)&&o<e.maxBusyTries)return o++,setTimeout((function(){f(t,e,n)}),100*o);if("EMFILE"===s.code&&u<e.emfileWait)return setTimeout((function(){f(t,e,n)}),u++);"ENOENT"===s.code&&(s=null)}u=0,function(t){i=i||t,0==--a&&r(i)}(s)}))}))}e.lstat(t,(function(r,n){if(!r)return c(null,[t]);s(t,e.glob,c)}))}function f(t,e,r){n(t),n(e),n("function"==typeof r),e.lstat(t,(function(n,o){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&l&&p(t,e,n,r),o&&o.isDirectory()?g(t,e,n,r):void e.unlink(t,(function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return l?p(t,e,n,r):g(t,e,n,r);if("EISDIR"===n.code)return g(t,e,n,r)}return r(n)})))}))}function p(t,e,r,o){n(t),n(e),n("function"==typeof o),r&&n(r instanceof Error),e.chmod(t,a,(function(n){n?o("ENOENT"===n.code?null:r):e.stat(t,(function(n,i){n?o("ENOENT"===n.code?null:r):i.isDirectory()?g(t,e,r,o):e.unlink(t,o)}))}))}function m(t,e,r){n(t),n(e),r&&n(r instanceof Error);try{e.chmodSync(t,a)}catch(t){if("ENOENT"===t.code)return;throw r}try{var o=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw r}o.isDirectory()?v(t,e,r):e.unlinkSync(t)}function g(t,e,r,i){n(t),n(e),r&&n(r instanceof Error),n("function"==typeof i),e.rmdir(t,(function(s){!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?i(r):i(s):function(t,e,r){n(t),n(e),n("function"==typeof r),e.readdir(t,(function(n,i){if(n)return r(n);var s,a=i.length;if(0===a)return e.rmdir(t,r);i.forEach((function(n){d(o.join(t,n),e,(function(n){if(!s)return n?r(s=n):void(0==--a&&e.rmdir(t,r))}))}))}))}(t,e,i)}))}function y(t,e){var r;if(h(e=e||{}),n(t,"rimraf: missing path"),n.equal(typeof t,"string","rimraf: path should be a string"),n(e,"rimraf: missing options"),n.equal(typeof e,"object","rimraf: options should be object"),e.disableGlob||!s.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch(n){r=s.sync(t,e.glob)}if(r.length)for(var o=0;o<r.length;o++){t=r[o];try{var i=e.lstatSync(t)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&l&&m(t,e,r)}try{i&&i.isDirectory()?v(t,e,null):e.unlinkSync(t)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return l?m(t,e,r):v(t,e,r);if("EISDIR"!==r.code)throw r;v(t,e,r)}}}function v(t,e,r){n(t),n(e),r&&n(r instanceof Error);try{e.rmdirSync(t)}catch(i){if("ENOENT"===i.code)return;if("ENOTDIR"===i.code)throw r;"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code||function(t,e){n(t),n(e),e.readdirSync(t).forEach((function(r){y(o.join(t,r),e)}));var r=l?100:1,i=0;for(;;){var s=!0;try{var a=e.rmdirSync(t,e);return s=!1,a}finally{if(++i<r&&s)continue}}}(t,e)}}},function(t,e,r){var n=r(1),o="win32"===process.platform,i=r(0),s=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function a(t){return"function"==typeof t?t:function(){var t;if(s){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}n.normalize;if(o)var c=/(.*?)(?:[\/\\]+|$)/g;else c=/(.*?)(?:[\/]+|$)/g;if(o)var u=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else u=/^[\/]*/;e.realpathSync=function(t,e){if(t=n.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,s,a,l,h=t,d={},f={};function p(){var e=u.exec(t);r=e[0].length,s=e[0],a=e[0],l="",o&&!f[a]&&(i.lstatSync(a),f[a]=!0)}for(p();r<t.length;){c.lastIndex=r;var m=c.exec(t);if(l=s,s+=m[0],a=l+m[1],r=c.lastIndex,!(f[a]||e&&e[a]===a)){var g;if(e&&Object.prototype.hasOwnProperty.call(e,a))g=e[a];else{var y=i.lstatSync(a);if(!y.isSymbolicLink()){f[a]=!0,e&&(e[a]=a);continue}var v=null;if(!o){var w=y.dev.toString(32)+":"+y.ino.toString(32);d.hasOwnProperty(w)&&(v=d[w])}null===v&&(i.statSync(a),v=i.readlinkSync(a)),g=n.resolve(l,v),e&&(e[a]=g),o||(d[w]=v)}t=n.resolve(g,t.slice(r)),p()}}return e&&(e[h]=t),t},e.realpath=function(t,e,r){if("function"!=typeof r&&(r=a(e),e=null),t=n.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var s,l,h,d,f=t,p={},m={};function g(){var e=u.exec(t);s=e[0].length,l=e[0],h=e[0],d="",o&&!m[h]?i.lstat(h,(function(t){if(t)return r(t);m[h]=!0,y()})):process.nextTick(y)}function y(){if(s>=t.length)return e&&(e[f]=t),r(null,t);c.lastIndex=s;var n=c.exec(t);return d=l,l+=n[0],h=d+n[1],s=c.lastIndex,m[h]||e&&e[h]===h?process.nextTick(y):e&&Object.prototype.hasOwnProperty.call(e,h)?b(e[h]):i.lstat(h,v)}function v(t,n){if(t)return r(t);if(!n.isSymbolicLink())return m[h]=!0,e&&(e[h]=h),process.nextTick(y);if(!o){var s=n.dev.toString(32)+":"+n.ino.toString(32);if(p.hasOwnProperty(s))return w(null,p[s],h)}i.stat(h,(function(t){if(t)return r(t);i.readlink(h,(function(t,e){o||(p[s]=e),w(t,e)}))}))}function w(t,o,i){if(t)return r(t);var s=n.resolve(d,o);e&&(e[i]=s),b(s)}function b(e){t=n.resolve(e,t.slice(s)),g()}g()}},function(t,e,r){var n=r(54),o=r(55);t.exports=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return function t(e,r){var i=[],s=o("{","}",e);if(!s||/\$$/.test(s.pre))return[e];var c,u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),h=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),g=u||h,y=s.body.indexOf(",")>=0;if(!g&&!y)return s.post.match(/,.*\}/)?(e=s.pre+"{"+s.body+a+s.post,t(e)):[e];if(g)c=s.body.split(/\.\./);else{if(1===(c=function t(e){if(!e)return[""];var r=[],n=o("{","}",e);if(!n)return e.split(",");var i=n.pre,s=n.body,a=n.post,c=i.split(",");c[c.length-1]+="{"+s+"}";var u=t(a);a.length&&(c[c.length-1]+=u.shift(),c.push.apply(c,u));return r.push.apply(r,c),r}(s.body)).length)if(1===(c=t(c[0],!1).map(d)).length)return(b=s.post.length?t(s.post,!1):[""]).map((function(t){return s.pre+c[0]+t}))}var v,w=s.pre,b=s.post.length?t(s.post,!1):[""];if(g){var _=l(c[0]),E=l(c[1]),O=Math.max(c[0].length,c[1].length),S=3==c.length?Math.abs(l(c[2])):1,A=p;E<_&&(S*=-1,A=m);var R=c.some(f);v=[];for(var C=_;A(C,E);C+=S){var x;if(h)"\\"===(x=String.fromCharCode(C))&&(x="");else if(x=String(C),R){var k=O-x.length;if(k>0){var T=new Array(k+1).join("0");x=C<0?"-"+T+x.slice(1):T+x}}v.push(x)}}else v=n(c,(function(e){return t(e,!1)}));for(var P=0;P<v.length;P++)for(var N=0;N<b.length;N++){var j=w+v[P]+b[N];(!r||g||j)&&i.push(j)}return i}(function(t){return t.split("\\\\").join(i).split("\\{").join(s).split("\\}").join(a).split("\\,").join(c).split("\\.").join(u)}(t),!0).map(h)};var i="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function l(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function h(t){return t.split(i).join("\\").split(s).join("{").split(a).join("}").split(c).join(",").split(u).join(".")}function d(t){return"{"+t+"}"}function f(t){return/^-?0\d/.test(t)}function p(t,e){return t<=e}function m(t,e){return t>=e}},function(t,e){t.exports=function(t,e){for(var n=[],o=0;o<t.length;o++){var i=e(t[o],o);r(i)?n.push.apply(n,i):n.push(i)}return n};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,r){"use strict";function n(t,e,r){t instanceof RegExp&&(t=o(t,r)),e instanceof RegExp&&(e=o(e,r));var n=i(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function o(t,e){var r=e.match(t);return r?r[0]:null}function i(t,e,r){var n,o,i,s,a,c=r.indexOf(t),u=r.indexOf(e,c+1),l=c;if(c>=0&&u>0){if(t===e)return[c,u];for(n=[],i=r.length;l>=0&&!a;)l==c?(n.push(l),c=r.indexOf(t,l+1)):1==n.length?a=[n.pop(),u]:((o=n.pop())<i&&(i=o,s=u),u=r.indexOf(e,l+1)),l=c<u&&c>=0?c:u;n.length&&(a=[i,s])}return a}t.exports=n,n.range=i},function(t,e,r){try{var n=r(3);if("function"!=typeof n.inherits)throw"";t.exports=n.inherits}catch(e){t.exports=r(57)}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},function(t,e,r){t.exports=f,f.GlobSync=p;var n=r(17),o=r(11),i=(o.Minimatch,r(16).Glob,r(3),r(1)),s=r(6),a=r(12),c=r(18),u=c.setopts,l=c.ownProp,h=c.childrenIgnored,d=c.isIgnored;function f(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new p(t,e).found}function p(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof p))return new p(t,e);if(u(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}p.prototype._finish=function(){if(s.ok(this instanceof p),this.realpath){var t=this;this.matches.forEach((function(e,r){var o=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),o[n.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;o[t._makeAbs(i)]=!0}}))}c.finish(this)},p.prototype._process=function(t,e,r){s.ok(this instanceof p);for(var n,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,i).join("/")}var c,u=t.slice(i);null===n?c=".":a(n)||a(t.map((function(t){return"string"==typeof t?t:"[*]"})).join("/"))?(n&&a(n)||(n="/"+n),c=n):c=n;var l=this._makeAbs(c);h(this,c)||(u[0]===o.GLOBSTAR?this._processGlobStar(n,c,l,u,e,r):this._processReaddir(n,c,l,u,e,r))},p.prototype._processReaddir=function(t,e,r,n,o,s){var a=this._readdir(r,s);if(a){for(var c=n[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||"."===l.charAt(0),d=[],f=0;f<a.length;f++){if("."!==(g=a[f]).charAt(0)||h)(u&&!t?!g.match(c):g.match(c))&&d.push(g)}var p=d.length;if(0!==p)if(1!==n.length||this.mark||this.stat){n.shift();for(f=0;f<p;f++){var m;g=d[f];m=t?[t,g]:[g],this._process(m.concat(n),o,s)}}else{this.matches[o]||(this.matches[o]=Object.create(null));for(var f=0;f<p;f++){var g=d[f];t&&(g="/"!==t.slice(-1)?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(o,g)}}}},p.prototype._emitMatch=function(t,e){if(!d(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},p.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=this.fs.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,n||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},p.prototype._readdir=function(t,e){if(e&&!l(this.symlinks,t))return this._readdirInGlobStar(t);if(l(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},p.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},p.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},p.prototype._processGlobStar=function(t,e,r,n,o,i){var s=this._readdir(r,i);if(s){var a=n.slice(1),c=t?[t]:[],u=c.concat(a);this._process(u,o,!1);var l=s.length;if(!this.symlinks[r]||!i)for(var h=0;h<l;h++){if("."!==s[h].charAt(0)||this.dot){var d=c.concat(s[h],a);this._process(d,o,!0);var f=c.concat(s[h],n);this._process(f,o,!0)}}}},p.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&a(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=i.join(this.root,t):(t=i.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},p.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&l(this.cache,e)){var n=this.cache[e];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var o=this.statCache[e];if(!o){var i;try{i=this.fs.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(i&&i.isSymbolicLink())try{o=this.fs.statSync(e)}catch(t){o=i}else o=i}this.statCache[e]=o;n=!0;return o&&(n=o.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||n,(!r||"FILE"!==n)&&n},p.prototype._mark=function(t){return c.mark(this,t)},p.prototype._makeAbs=function(t){return c.makeAbs(this,t)}},function(t,e,r){var n=r(19),o=Object.create(null),i=r(20);function s(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}t.exports=n((function(t,e){return o[t]?(o[t].push(e),null):(o[t]=[e],function(t){return i((function e(){var r=o[t],n=r.length,i=s(arguments);try{for(var a=0;a<n;a++)r[a].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick((function(){e.apply(null,i)}))):delete o[t]}}))}(t))}))},function(t,e){t.exports=require("stream")},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const s=i(r(0)),a=i(r(25)),c=r(3).promisify(s.stat);e.createGZipFileOnDisk=function(t,e){return n(this,void 0,void 0,(function*(){return new Promise((r,o)=>{const i=s.createReadStream(t),u=a.createGzip(),l=s.createWriteStream(e);i.pipe(u).pipe(l),l.on("finish",()=>n(this,void 0,void 0,(function*(){const t=(yield c(e)).size;r(t)}))),l.on("error",t=>{console.log(t)})})}))},e.createGZipFileInBuffer=function(t){return n(this,void 0,void 0,(function*(){return new Promise(e=>n(this,void 0,void 0,(function*(){var r,n;const i=s.createReadStream(t),c=a.createGzip();i.pipe(c);const u=[];try{for(var l,h=o(c);!(l=yield h.next()).done;){const t=l.value;u.push(t)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=h.return)&&(yield n.call(h))}finally{if(r)throw r.error}}e(Buffer.concat(u))})))}))}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(0)),s=o(r(2)),a=o(r(25)),c=r(5),u=r(21),l=r(23),h=r(22),d=r(24),f=r(7);e.DownloadHttpClient=class{constructor(){this.downloadHttpManager=new d.HttpManager(f.getDownloadFileConcurrency(),"@actions/artifact-download"),this.statusReporter=new l.StatusReporter(1e3)}listArtifacts(){return n(this,void 0,void 0,(function*(){const t=c.getArtifactUrl(),e=this.downloadHttpManager.getClient(0),r=c.getDownloadHeaders("application/json"),n=yield e.get(t,r),o=yield n.readBody();if(c.isSuccessStatusCode(n.message.statusCode)&&o)return JSON.parse(o);throw c.displayHttpDiagnostics(n),new Error("Unable to list artifacts for the run. Resource Url "+t)}))}getContainerItems(t,e){return n(this,void 0,void 0,(function*(){const r=new u.URL(e);r.searchParams.append("itemPath",t);const n=this.downloadHttpManager.getClient(0),o=c.getDownloadHeaders("application/json"),i=yield n.get(r.toString(),o),s=yield i.readBody();if(c.isSuccessStatusCode(i.message.statusCode)&&s)return JSON.parse(s);throw c.displayHttpDiagnostics(i),new Error("Unable to get ContainersItems from "+r)}))}downloadSingleArtifact(t){return n(this,void 0,void 0,(function*(){const e=f.getDownloadFileConcurrency();s.debug("Download file concurrency is set to "+e);const r=[...new Array(e).keys()];let o=0,i=0;s.info("Total number of files that will be downloaded: "+t.length),this.statusReporter.setTotalNumberOfFilesToProcess(t.length),this.statusReporter.start(),yield Promise.all(r.map(e=>n(this,void 0,void 0,(function*(){for(;o<t.length;){const r=t[o];o+=1;const n=h.performance.now();yield this.downloadIndividualFile(e,r.sourceLocation,r.targetPath),s.isDebug()&&s.debug(`File: ${++i}/${t.length}. ${r.targetPath} took ${(h.performance.now()-n).toFixed(3)} milliseconds to finish downloading`),this.statusReporter.incrementProcessedCount()}})))).catch(t=>{throw new Error("Unable to download the artifact: "+t)}).finally(()=>{this.statusReporter.stop(),this.downloadHttpManager.disposeAndReplaceAllClients()})}))}downloadIndividualFile(t,e,r){return n(this,void 0,void 0,(function*(){let o=0;const a=f.getRetryLimit();let u=i.createWriteStream(r);const l=c.getDownloadHeaders("application/json",!0,!0),h=()=>n(this,void 0,void 0,(function*(){const r=this.downloadHttpManager.getClient(t);return yield r.get(e,l)})),d=r=>n(this,void 0,void 0,(function*(){if(o++,o>a)return Promise.reject(new Error("Retry limit has been reached. Unable to download "+e));if(this.downloadHttpManager.disposeAndReplaceClient(t),r)s.info(`Backoff due to too many requests, retry #${o}. Waiting for ${r} milliseconds before continuing the download`),yield new Promise(t=>setTimeout(t,r));else{const t=c.getExponentialRetryTimeInMilliseconds(o);s.info(`Exponential backoff for retry #${o}. Waiting for ${t} milliseconds before continuing the download`),yield new Promise(e=>setTimeout(e,t))}s.info(`Finished backoff for retry #${o}, continuing with download`)})),p=t=>n(this,void 0,void 0,(function*(){u.close(),yield c.rmFile(t),u=i.createWriteStream(t)}));for(;o<=a;){let t;try{t=yield h(),s.isDebug()&&c.displayHttpDiagnostics(t)}catch(t){s.info("An error occurred while attempting to download a file"),console.log(t),yield d();continue}let n=!1;if(c.isSuccessStatusCode(t.message.statusCode))try{const e="content-encoding"in(y=t.message.headers)&&"gzip"===y["content-encoding"];if(yield this.pipeResponseToFile(t,u,e),e||(m=t.message.headers["content-length"],g=yield c.getFileSize(r),m&&g&&!process.env.ACTIONS_ARTIFACT_SKIP_DOWNLOAD_VALIDATION?parseInt(m)===g:(s.info("Skipping download validation."),1)))return;n=!0}catch(t){n=!0}if(!n&&!c.isRetryableStatusCode(t.message.statusCode))return c.displayHttpDiagnostics(t),Promise.reject(new Error(`Unexpected http ${t.message.statusCode} during download for ${e}`));s.info(`A ${t.message.statusCode} response code has been received while attempting to download an artifact`),p(r),c.isThrottledStatusCode(t.message.statusCode)?yield d(c.tryGetRetryAfterValueTimeInMilliseconds(t.message.headers)):yield d()}var m,g,y}))}pipeResponseToFile(t,e,r){return n(this,void 0,void 0,(function*(){yield new Promise((n,o)=>{if(r){const r=a.createGunzip();t.message.on("error",t=>{s.error("An error occurred while attempting to read the response stream"),r.close(),e.close(),o(t)}).pipe(r).on("error",t=>{s.error("An error occurred while attempting to decompress the response stream"),e.close(),o(t)}).pipe(e).on("close",()=>{n()}).on("error",t=>{s.error("An error occurred while writing a downloaded file to "+e.path),o(t)})}else t.message.on("error",t=>{s.error("An error occurred while attempting to read the response stream"),e.close(),o(t)}).pipe(e).on("close",()=>{n()}).on("error",t=>{s.error("An error occurred while writing a downloaded file to "+e.path),o(t)})})}))}}},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(r(1));e.getDownloadSpecification=function(t,e,r,n){const i=new Set,s={rootDownloadLocation:n?o.join(r,t):r,directoryStructure:[],emptyFilesToCreate:[],filesToDownload:[]};for(const a of e)if(a.path.startsWith(t+"/")||a.path.startsWith(t+"\\")){const e=o.normalize(a.path),c=o.join(r,n?e:e.replace(t,""));"file"===a.itemType&&(i.add(o.dirname(c)),0===a.fileLength?s.emptyFilesToCreate.push(c):s.filesToDownload.push({sourceLocation:a.contentLocation,targetPath:c}))}return s.directoryStructure=Array.from(i),s}},function(t,e,r){const n=r(2);e.getInput=(t,e=!1)=>n.getInput(t,{required:e}),e.writeOutput=(t,e)=>{n.setOutput(t,e)},e.fail=t=>n.setFailed(t)}]);